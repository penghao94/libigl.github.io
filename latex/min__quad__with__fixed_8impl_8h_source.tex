\doxysection{min\+\_\+quad\+\_\+with\+\_\+fixed.\+impl.\+h}
\hypertarget{min__quad__with__fixed_8impl_8h_source}{}\label{min__quad__with__fixed_8impl_8h_source}\index{include/igl/min\_quad\_with\_fixed.impl.h@{include/igl/min\_quad\_with\_fixed.impl.h}}
\mbox{\hyperlink{min__quad__with__fixed_8impl_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ This\ file\ is\ part\ of\ libigl,\ a\ simple\ c++\ geometry\ processing\ library.}}
\DoxyCodeLine{00002\ \textcolor{comment}{//}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ Copyright\ (C)\ 2016\ Alec\ Jacobson\ <alecjacobson@gmail.com>}}
\DoxyCodeLine{00004\ \textcolor{comment}{//}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ This\ Source\ Code\ Form\ is\ subject\ to\ the\ terms\ of\ the\ Mozilla\ Public\ License}}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ v.\ 2.0.\ If\ a\ copy\ of\ the\ MPL\ was\ not\ distributed\ with\ this\ file,\ You\ can}}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ obtain\ one\ at\ http://mozilla.org/MPL/2.0/.}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{min__quad__with__fixed_8h}{min\_quad\_with\_fixed.h}}"{}}}
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{slice_8h}{slice.h}}"{}}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{is__symmetric_8h}{is\_symmetric.h}}"{}}}
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{find_8h}{find.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{sparse_8h}{sparse.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{repmat_8h}{repmat.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{EPS_8h}{EPS.h}}"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{cat_8h}{cat.h}}"{}}}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{comment}{//\#include\ <Eigen/SparseExtra>}}
\DoxyCodeLine{00021\ \textcolor{comment}{//\ Bug\ in\ unsupported/Eigen/SparseExtra\ needs\ iostream\ first}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ <iostream>}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ <unsupported/Eigen/SparseExtra>}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ <cassert>}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ <cstdio>}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{matlab__format_8h}{matlab\_format.h}}"{}}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#include\ <type\_traits>}}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T,\ \textcolor{keyword}{typename}\ Derivedknown>}
\DoxyCodeLine{00030\ \mbox{\hyperlink{igl__inline_8h_a838241279013352686271b4c4ce1f708}{IGL\_INLINE}}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespaceigl_adc0382628e374a5b92a226ad75ce6b8b}{igl::min\_quad\_with\_fixed\_precompute}}(}
\DoxyCodeLine{00031\ \ \ \textcolor{keyword}{const}\ Eigen::SparseMatrix<T>\&\ A2,}
\DoxyCodeLine{00032\ \ \ \textcolor{keyword}{const}\ Eigen::MatrixBase<Derivedknown>\ \&\ known,}
\DoxyCodeLine{00033\ \ \ \textcolor{keyword}{const}\ Eigen::SparseMatrix<T>\&\ Aeq,}
\DoxyCodeLine{00034\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ pd,}
\DoxyCodeLine{00035\ \ \ \mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data}{min\_quad\_with\_fixed\_data<T>}}\ \&\ data}
\DoxyCodeLine{00036\ \ \ )}
\DoxyCodeLine{00037\ \{}
\DoxyCodeLine{00038\ \textcolor{comment}{//\#define\ MIN\_QUAD\_WITH\_FIXED\_CPP\_DEBUG}}
\DoxyCodeLine{00039\ \ \ \textcolor{keyword}{using\ namespace\ }Eigen;}
\DoxyCodeLine{00040\ \ \ \textcolor{keyword}{using\ namespace\ }std;}
\DoxyCodeLine{00041\ \ \ \textcolor{keyword}{const}\ Eigen::SparseMatrix<T>\ A\ =\ 0.5*A2;}
\DoxyCodeLine{00042\ \textcolor{preprocessor}{\#ifdef\ MIN\_QUAD\_WITH\_FIXED\_CPP\_DEBUG}}
\DoxyCodeLine{00043\ \ \ cout<<\textcolor{stringliteral}{"{}\ \ \ \ pre"{}}<<endl;}
\DoxyCodeLine{00044\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00045\ \ \ \textcolor{comment}{//\ number\ of\ rows}}
\DoxyCodeLine{00046\ \ \ \textcolor{keywordtype}{int}\ n\ =\ A.rows();}
\DoxyCodeLine{00047\ \ \ \textcolor{comment}{//\ cache\ problem\ size}}
\DoxyCodeLine{00048\ \ \ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_aa2f79821dd5f69c2c704d4f8d2e0c34d}{n}}\ =\ n;}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00050\ \ \ \textcolor{keywordtype}{int}\ neq\ =\ Aeq.rows();}
\DoxyCodeLine{00051\ \ \ \textcolor{comment}{//\ default\ is\ to\ have\ 0\ linear\ equality\ constraints}}
\DoxyCodeLine{00052\ \ \ \textcolor{keywordflow}{if}(Aeq.size()\ !=\ 0)}
\DoxyCodeLine{00053\ \ \ \{}
\DoxyCodeLine{00054\ \ \ \ \ assert(n\ ==\ Aeq.cols()\ \&\&\ \textcolor{stringliteral}{"{}\#Aeq.cols()\ should\ match\ A.rows()"{}});}
\DoxyCodeLine{00055\ \ \ \}}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ \ \ assert(known.cols()\ ==\ 1\ \&\&\ \textcolor{stringliteral}{"{}known\ should\ be\ a\ vector"{}});}
\DoxyCodeLine{00058\ \ \ assert(A.rows()\ ==\ n\ \&\&\ \textcolor{stringliteral}{"{}A\ should\ be\ square"{}});}
\DoxyCodeLine{00059\ \ \ assert(A.cols()\ ==\ n\ \&\&\ \textcolor{stringliteral}{"{}A\ should\ be\ square"{}});}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00061\ \ \ \textcolor{comment}{//\ number\ of\ known\ rows}}
\DoxyCodeLine{00062\ \ \ \textcolor{keywordtype}{int}\ kr\ =\ known.size();}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00064\ \ \ assert((kr\ ==\ 0\ ||\ known.minCoeff()\ >=\ 0)\&\&\ \textcolor{stringliteral}{"{}known\ indices\ should\ be\ in\ [0,n)"{}});}
\DoxyCodeLine{00065\ \ \ assert((kr\ ==\ 0\ ||\ known.maxCoeff()\ <\ n)\ \&\&\ \textcolor{stringliteral}{"{}known\ indices\ should\ be\ in\ [0,n)"{}});}
\DoxyCodeLine{00066\ \ \ assert(neq\ <=\ n\ \&\&\ \textcolor{stringliteral}{"{}Number\ of\ equality\ constraints\ should\ be\ less\ than\ DOFs"{}});}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00068\ }
\DoxyCodeLine{00069\ \ \ \textcolor{comment}{//\ cache\ known}}
\DoxyCodeLine{00070\ \ \ \textcolor{comment}{//\ FIXME:\ This\ is\ *NOT*\ generic\ and\ introduces\ a\ copy.}}
\DoxyCodeLine{00071\ \ \ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a0b135eb50ef96353f9959dbfdc4e9844}{known}}\ =\ known.template\ cast<int>();}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \ \ \textcolor{comment}{//\ get\ list\ of\ unknown\ indices}}
\DoxyCodeLine{00074\ \ \ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a45a26b0e5d41d28bfea348ee51f52e4b}{unknown}}.resize(n-\/kr);}
\DoxyCodeLine{00075\ \ \ std::vector<bool>\ unknown\_mask;}
\DoxyCodeLine{00076\ \ \ unknown\_mask.resize(n,\textcolor{keyword}{true});}
\DoxyCodeLine{00077\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;i<kr;i++)}
\DoxyCodeLine{00078\ \ \ \{}
\DoxyCodeLine{00079\ \ \ \ \ unknown\_mask[known(i,\ 0)]\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00080\ \ \ \}}
\DoxyCodeLine{00081\ \ \ \textcolor{keywordtype}{int}\ u\ =\ 0;}
\DoxyCodeLine{00082\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;i<n;i++)}
\DoxyCodeLine{00083\ \ \ \{}
\DoxyCodeLine{00084\ \ \ \ \ \textcolor{keywordflow}{if}(unknown\_mask[i])}
\DoxyCodeLine{00085\ \ \ \ \ \{}
\DoxyCodeLine{00086\ \ \ \ \ \ \ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a45a26b0e5d41d28bfea348ee51f52e4b}{unknown}}(u)\ =\ i;}
\DoxyCodeLine{00087\ \ \ \ \ \ \ u++;}
\DoxyCodeLine{00088\ \ \ \ \ \}}
\DoxyCodeLine{00089\ \ \ \}}
\DoxyCodeLine{00090\ \ \ \textcolor{comment}{//\ get\ list\ of\ lagrange\ multiplier\ indices}}
\DoxyCodeLine{00091\ \ \ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_ab07863971db161e5eb7cdf2ec28afb06}{lagrange}}.resize(neq);}
\DoxyCodeLine{00092\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;i<neq;i++)}
\DoxyCodeLine{00093\ \ \ \{}
\DoxyCodeLine{00094\ \ \ \ \ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_ab07863971db161e5eb7cdf2ec28afb06}{lagrange}}(i)\ =\ n\ +\ i;}
\DoxyCodeLine{00095\ \ \ \}}
\DoxyCodeLine{00096\ \ \ \textcolor{comment}{//\ cache\ unknown\ followed\ by\ lagrange\ indices}}
\DoxyCodeLine{00097\ \ \ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_ac680271bddf24abc8337ca15965a200d}{unknown\_lagrange}}.resize(data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a45a26b0e5d41d28bfea348ee51f52e4b}{unknown}}.size()+data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_ab07863971db161e5eb7cdf2ec28afb06}{lagrange}}.size());}
\DoxyCodeLine{00098\ \ \ \textcolor{comment}{//\ Would\ like\ to\ do:}}
\DoxyCodeLine{00099\ \ \ \textcolor{comment}{//data.unknown\_lagrange\ <<\ data.unknown,\ data.lagrange;}}
\DoxyCodeLine{00100\ \ \ \textcolor{comment}{//\ but\ Eigen\ can't\ handle\ empty\ vectors\ in\ comma\ initialization}}
\DoxyCodeLine{00101\ \ \ \textcolor{comment}{//\ https://forum.kde.org/viewtopic.php?f=74\&t=107974\&p=364947\#p364947}}
\DoxyCodeLine{00102\ \ \ \textcolor{keywordflow}{if}(data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a45a26b0e5d41d28bfea348ee51f52e4b}{unknown}}.size()\ >\ 0)}
\DoxyCodeLine{00103\ \ \ \{}
\DoxyCodeLine{00104\ \ \ \ \ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_ac680271bddf24abc8337ca15965a200d}{unknown\_lagrange}}.head(data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a45a26b0e5d41d28bfea348ee51f52e4b}{unknown}}.size())\ =\ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a45a26b0e5d41d28bfea348ee51f52e4b}{unknown}};}
\DoxyCodeLine{00105\ \ \ \}}
\DoxyCodeLine{00106\ \ \ \textcolor{keywordflow}{if}(data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_ab07863971db161e5eb7cdf2ec28afb06}{lagrange}}.size()\ >\ 0)}
\DoxyCodeLine{00107\ \ \ \{}
\DoxyCodeLine{00108\ \ \ \ \ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_ac680271bddf24abc8337ca15965a200d}{unknown\_lagrange}}.tail(data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_ab07863971db161e5eb7cdf2ec28afb06}{lagrange}}.size())\ =\ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_ab07863971db161e5eb7cdf2ec28afb06}{lagrange}};}
\DoxyCodeLine{00109\ \ \ \}}
\DoxyCodeLine{00110\ }
\DoxyCodeLine{00111\ \ \ SparseMatrix<T>\ Auu;}
\DoxyCodeLine{00112\ \ \ \mbox{\hyperlink{namespaceigl_a547a8704200d3af48fe92105c15a32ad}{slice}}(A,data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a45a26b0e5d41d28bfea348ee51f52e4b}{unknown}},data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a45a26b0e5d41d28bfea348ee51f52e4b}{unknown}},Auu);}
\DoxyCodeLine{00113\ \ \ assert(Auu.size()\ !=\ 0\ \&\&\ Auu.rows()\ >\ 0\ \&\&\ \textcolor{stringliteral}{"{}There\ should\ be\ at\ least\ one\ unknown."{}});}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00115\ \ \ \textcolor{comment}{//\ Positive\ definiteness\ is\ *not*\ determined,\ rather\ it\ is\ given\ as\ a}}
\DoxyCodeLine{00116\ \ \ \textcolor{comment}{//\ parameter}}
\DoxyCodeLine{00117\ \ \ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_ad3ec9b5eb512ccd82dc39fc7c670eae5}{Auu\_pd}}\ =\ pd;}
\DoxyCodeLine{00118\ \ \ \textcolor{keywordflow}{if}(data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_ad3ec9b5eb512ccd82dc39fc7c670eae5}{Auu\_pd}})}
\DoxyCodeLine{00119\ \ \ \{}
\DoxyCodeLine{00120\ \ \ \ \ \textcolor{comment}{//\ PD\ implies\ symmetric}}
\DoxyCodeLine{00121\ \ \ \ \ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_ab1604a8b1d543c6dfc4ac01dc42df0a6}{Auu\_sym}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00122\ \ \ \ \ \textcolor{comment}{//\ This\ is\ an\ annoying\ assertion\ unless\ EPS\ can\ be\ chosen\ in\ a\ nicer\ way.}}
\DoxyCodeLine{00123\ \ \ \ \ \textcolor{comment}{//assert(is\_symmetric(Auu,EPS<T>()));}}
\DoxyCodeLine{00124\ \ \ \ \ assert(\mbox{\hyperlink{namespaceigl_a4f840791a21ca650ec1d68910c3ec900}{is\_symmetric}}(Auu,1.0)\ \&\&}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Auu\ should\ be\ symmetric\ if\ positive\ definite"{}});}
\DoxyCodeLine{00126\ \ \ \}\textcolor{keywordflow}{else}}
\DoxyCodeLine{00127\ \ \ \{}
\DoxyCodeLine{00128\ \ \ \ \ \textcolor{comment}{//\ determine\ if\ A(unknown,unknown)\ is\ symmetric\ and/or\ positive\ definite}}
\DoxyCodeLine{00129\ \ \ \ \ VectorXi\ AuuI,AuuJ;}
\DoxyCodeLine{00130\ \ \ \ \ Matrix<T,Eigen::Dynamic,Eigen::Dynamic>\ AuuV;}
\DoxyCodeLine{00131\ \ \ \ \ \mbox{\hyperlink{namespaceigl_ad0ba264f987871035fb7d12de96fccab}{find}}(Auu,AuuI,AuuJ,AuuV);}
\DoxyCodeLine{00132\ \ \ \ \ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_ab1604a8b1d543c6dfc4ac01dc42df0a6}{Auu\_sym}}\ =\ \mbox{\hyperlink{namespaceigl_a4f840791a21ca650ec1d68910c3ec900}{is\_symmetric}}(Auu,EPS<T>()*AuuV.maxCoeff());}
\DoxyCodeLine{00133\ \ \ \}}
\DoxyCodeLine{00134\ }
\DoxyCodeLine{00135\ \ \ \textcolor{comment}{//\ Determine\ number\ of\ linearly\ independent\ constraints}}
\DoxyCodeLine{00136\ \ \ \textcolor{keywordtype}{int}\ nc\ =\ 0;}
\DoxyCodeLine{00137\ \ \ \textcolor{keywordflow}{if}(neq>0)}
\DoxyCodeLine{00138\ \ \ \{}
\DoxyCodeLine{00139\ \textcolor{preprocessor}{\#ifdef\ MIN\_QUAD\_WITH\_FIXED\_CPP\_DEBUG}}
\DoxyCodeLine{00140\ \ \ \ \ cout<<\textcolor{stringliteral}{"{}\ \ \ \ qr"{}}<<endl;}
\DoxyCodeLine{00141\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00142\ \ \ \ \ \textcolor{comment}{//\ QR\ decomposition\ to\ determine\ row\ rank\ in\ Aequ}}
\DoxyCodeLine{00143\ \ \ \ \ \mbox{\hyperlink{namespaceigl_a547a8704200d3af48fe92105c15a32ad}{slice}}(Aeq,data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a45a26b0e5d41d28bfea348ee51f52e4b}{unknown}},2,data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_ae7eec6673505fc46af7fb9e65aa6c426}{Aequ}});}
\DoxyCodeLine{00144\ \ \ \ \ assert(data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_ae7eec6673505fc46af7fb9e65aa6c426}{Aequ}}.rows()\ ==\ neq\ \&\&}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\#Rows\ in\ Aequ\ should\ match\ \#constraints"{}});}
\DoxyCodeLine{00146\ \ \ \ \ assert(data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_ae7eec6673505fc46af7fb9e65aa6c426}{Aequ}}.cols()\ ==\ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a45a26b0e5d41d28bfea348ee51f52e4b}{unknown}}.size()\ \&\&}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\#cols\ in\ Aequ\ should\ match\ \#unknowns"{}});}
\DoxyCodeLine{00148\ \ \ \ \ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a0dd37f713f6578dc75ab710458d4654c}{AeqTQR}}.compute(data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_ae7eec6673505fc46af7fb9e65aa6c426}{Aequ}}.transpose().eval());}
\DoxyCodeLine{00149\ \textcolor{preprocessor}{\#ifdef\ MIN\_QUAD\_WITH\_FIXED\_CPP\_DEBUG}}
\DoxyCodeLine{00150\ \ \ \ \ \textcolor{comment}{//cout<<endl<<matlab\_format(SparseMatrix<T>(data.Aequ.transpose().eval()),"{}AeqT"{})<<endl<<endl;}}
\DoxyCodeLine{00151\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00152\ \ \ \ \ \textcolor{keywordflow}{switch}(data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a0dd37f713f6578dc75ab710458d4654c}{AeqTQR}}.info())}
\DoxyCodeLine{00153\ \ \ \ \ \{}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Eigen::Success:}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Eigen::NumericalIssue:}
\DoxyCodeLine{00157\ \textcolor{preprocessor}{\#ifdef\ IGL\_MIN\_QUAD\_WITH\_FIXED\_CPP\_DEBUG}}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ cerr<<\textcolor{stringliteral}{"{}Error:\ Numerical\ issue."{}}<<endl;}
\DoxyCodeLine{00159\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Eigen::InvalidInput:}
\DoxyCodeLine{00162\ \textcolor{preprocessor}{\#ifdef\ IGL\_MIN\_QUAD\_WITH\_FIXED\_CPP\_DEBUG}}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ cerr<<\textcolor{stringliteral}{"{}Error:\ Invalid\ input."{}}<<endl;}
\DoxyCodeLine{00164\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00167\ \textcolor{preprocessor}{\#ifdef\ IGL\_MIN\_QUAD\_WITH\_FIXED\_CPP\_DEBUG}}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ cerr<<\textcolor{stringliteral}{"{}Error:\ Other."{}}<<endl;}
\DoxyCodeLine{00169\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00171\ \ \ \ \ \}}
\DoxyCodeLine{00172\ \ \ \ \ nc\ =\ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a0dd37f713f6578dc75ab710458d4654c}{AeqTQR}}.rank();}
\DoxyCodeLine{00173\ \ \ \ \ assert(nc<=neq\ \&\&}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Rank\ of\ reduced\ constraints\ should\ be\ <=\ \#original\ constraints"{}});}
\DoxyCodeLine{00175\ \ \ \ \ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_aae738302bbd952761f3e48fcaa1b11f9}{Aeq\_li}}\ =\ nc\ ==\ neq;}
\DoxyCodeLine{00176\ \ \ \ \ \textcolor{comment}{//cout<<"{}data.Aeq\_li:\ "{}<<data.Aeq\_li<<endl;}}
\DoxyCodeLine{00177\ \ \ \}\textcolor{keywordflow}{else}}
\DoxyCodeLine{00178\ \ \ \{}
\DoxyCodeLine{00179\ \ \ \ \ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_aae738302bbd952761f3e48fcaa1b11f9}{Aeq\_li}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00180\ \ \ \}}
\DoxyCodeLine{00181\ }
\DoxyCodeLine{00182\ \ \ \textcolor{keywordflow}{if}(data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_aae738302bbd952761f3e48fcaa1b11f9}{Aeq\_li}})}
\DoxyCodeLine{00183\ \ \ \{}
\DoxyCodeLine{00184\ \textcolor{preprocessor}{\#ifdef\ MIN\_QUAD\_WITH\_FIXED\_CPP\_DEBUG}}
\DoxyCodeLine{00185\ \ \ \ \ cout<<\textcolor{stringliteral}{"{}\ \ \ \ Aeq\_li=true"{}}<<endl;}
\DoxyCodeLine{00186\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00187\ \ \ \ \ \textcolor{comment}{//\ Append\ lagrange\ multiplier\ quadratic\ terms}}
\DoxyCodeLine{00188\ \ \ \ \ SparseMatrix<T>\ new\_A;}
\DoxyCodeLine{00189\ \ \ \ \ SparseMatrix<T>\ AeqT\ =\ Aeq.transpose();}
\DoxyCodeLine{00190\ \ \ \ \ SparseMatrix<T>\ Z(neq,neq);}
\DoxyCodeLine{00191\ \ \ \ \ \textcolor{comment}{//\ This\ is\ a\ bit\ slower.\ But\ why\ isn't\ cat\ fast?}}
\DoxyCodeLine{00192\ \ \ \ \ new\_A\ =\ \mbox{\hyperlink{namespaceigl_ad5f624eb7c4015b813215c87880eb54d}{cat}}(1,\ \mbox{\hyperlink{namespaceigl_ad5f624eb7c4015b813215c87880eb54d}{cat}}(2,\ \ \ A,\ AeqT\ ),}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceigl_ad5f624eb7c4015b813215c87880eb54d}{cat}}(2,\ Aeq,\ \ \ \ Z\ ));}
\DoxyCodeLine{00194\ }
\DoxyCodeLine{00195\ \ \ \ \ \textcolor{comment}{//\ precompute\ RHS\ builders}}
\DoxyCodeLine{00196\ \ \ \ \ \textcolor{keywordflow}{if}(kr\ >\ 0)}
\DoxyCodeLine{00197\ \ \ \ \ \{}
\DoxyCodeLine{00198\ \ \ \ \ \ \ SparseMatrix<T>\ Aulk,Akul;}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \textcolor{comment}{//\ Slow}}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \mbox{\hyperlink{namespaceigl_a547a8704200d3af48fe92105c15a32ad}{slice}}(new\_A,data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_ac680271bddf24abc8337ca15965a200d}{unknown\_lagrange}},data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a0b135eb50ef96353f9959dbfdc4e9844}{known}},Aulk);}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \textcolor{comment}{//data.preY\ =\ Aulk\ +\ Akul.transpose();}}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \textcolor{comment}{//\ Slow}}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_ab1604a8b1d543c6dfc4ac01dc42df0a6}{Auu\_sym}})}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a3db371095ff5ecf7dc8c42c3e34a3695}{preY}}\ =\ Aulk*2;}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \}\textcolor{keywordflow}{else}}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceigl_a547a8704200d3af48fe92105c15a32ad}{slice}}(new\_A,data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a0b135eb50ef96353f9959dbfdc4e9844}{known}},data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_ac680271bddf24abc8337ca15965a200d}{unknown\_lagrange}},Akul);}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ SparseMatrix<T>\ AkulT\ =\ Akul.transpose();}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a3db371095ff5ecf7dc8c42c3e34a3695}{preY}}\ =\ Aulk\ +\ AkulT;}
\DoxyCodeLine{00212\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00213\ \ \ \ \ \}\textcolor{keywordflow}{else}}
\DoxyCodeLine{00214\ \ \ \ \ \{}
\DoxyCodeLine{00215\ \ \ \ \ \ \ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a3db371095ff5ecf7dc8c42c3e34a3695}{preY}}.resize(data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_ac680271bddf24abc8337ca15965a200d}{unknown\_lagrange}}.size(),0);}
\DoxyCodeLine{00216\ \ \ \ \ \}}
\DoxyCodeLine{00217\ }
\DoxyCodeLine{00218\ \ \ \ \ \textcolor{comment}{//\ Positive\ definite\ and\ no\ equality\ constraints\ (Positive\ definiteness}}
\DoxyCodeLine{00219\ \ \ \ \ \textcolor{comment}{//\ implies\ symmetric)}}
\DoxyCodeLine{00220\ \textcolor{preprocessor}{\#ifdef\ MIN\_QUAD\_WITH\_FIXED\_CPP\_DEBUG}}
\DoxyCodeLine{00221\ \ \ \ \ cout<<\textcolor{stringliteral}{"{}\ \ \ \ factorize"{}}<<endl;}
\DoxyCodeLine{00222\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00223\ \ \ \ \ \textcolor{keywordflow}{if}(data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_ad3ec9b5eb512ccd82dc39fc7c670eae5}{Auu\_pd}}\ \&\&\ neq\ ==\ 0)}
\DoxyCodeLine{00224\ \ \ \ \ \{}
\DoxyCodeLine{00225\ \textcolor{preprocessor}{\#ifdef\ MIN\_QUAD\_WITH\_FIXED\_CPP\_DEBUG}}
\DoxyCodeLine{00226\ \ \ \ \ cout<<\textcolor{stringliteral}{"{}\ \ \ \ llt"{}}<<endl;}
\DoxyCodeLine{00227\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00228\ \ \ \ \ \ \ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a4ef765c434c7997a24378788a7fd9c84}{llt}}.compute(Auu);}
\DoxyCodeLine{00229\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}(data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a4ef765c434c7997a24378788a7fd9c84}{llt}}.info())}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Eigen::Success:}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Eigen::NumericalIssue:}
\DoxyCodeLine{00234\ \textcolor{preprocessor}{\#ifdef\ IGL\_MIN\_QUAD\_WITH\_FIXED\_CPP\_DEBUG}}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ \ \ cerr<<\textcolor{stringliteral}{"{}Error:\ Numerical\ issue."{}}<<endl;}
\DoxyCodeLine{00236\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00239\ \textcolor{preprocessor}{\#ifdef\ IGL\_MIN\_QUAD\_WITH\_FIXED\_CPP\_DEBUG}}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ \ \ cerr<<\textcolor{stringliteral}{"{}Error:\ Other."{}}<<endl;}
\DoxyCodeLine{00241\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00244\ \ \ \ \ \ \ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_adf555171e037b12e5177ebd81fd33de5}{solver\_type}}\ =\ \mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data}{min\_quad\_with\_fixed\_data<T>::LLT}};}
\DoxyCodeLine{00245\ \ \ \ \ \}\textcolor{keywordflow}{else}}
\DoxyCodeLine{00246\ \ \ \ \ \{}
\DoxyCodeLine{00247\ \textcolor{preprocessor}{\#ifdef\ MIN\_QUAD\_WITH\_FIXED\_CPP\_DEBUG}}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ cout<<\textcolor{stringliteral}{"{}\ \ \ \ ldlt/lu"{}}<<endl;}
\DoxyCodeLine{00249\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \textcolor{comment}{//\ Either\ not\ PD\ or\ there\ are\ equality\ constraints}}
\DoxyCodeLine{00251\ \ \ \ \ \ \ SparseMatrix<T>\ NA;}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \mbox{\hyperlink{namespaceigl_a547a8704200d3af48fe92105c15a32ad}{slice}}(new\_A,data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_ac680271bddf24abc8337ca15965a200d}{unknown\_lagrange}},data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_ac680271bddf24abc8337ca15965a200d}{unknown\_lagrange}},NA);}
\DoxyCodeLine{00253\ \ \ \ \ \ \ data.NA\ =\ NA;}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_ad3ec9b5eb512ccd82dc39fc7c670eae5}{Auu\_pd}})}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00256\ \textcolor{preprocessor}{\#ifdef\ MIN\_QUAD\_WITH\_FIXED\_CPP\_DEBUG}}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \ \ cout<<\textcolor{stringliteral}{"{}\ \ \ \ ldlt"{}}<<endl;}
\DoxyCodeLine{00258\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a1bd2d40db9381b99df7cafafa3e9b8ac}{ldlt}}.compute(NA);}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}(data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a1bd2d40db9381b99df7cafafa3e9b8ac}{ldlt}}.info())}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00262\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Eigen::Success:}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Eigen::NumericalIssue:}
\DoxyCodeLine{00265\ \textcolor{preprocessor}{\#ifdef\ MIN\_QUAD\_WITH\_FIXED\_CPP\_DEBUG}}
\DoxyCodeLine{00266\ \ \ \ \ \ \ \ \ \ \ \ \ cerr<<\textcolor{stringliteral}{"{}Error:\ Numerical\ issue."{}}<<endl;}
\DoxyCodeLine{00267\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00268\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00270\ \textcolor{preprocessor}{\#ifdef\ MIN\_QUAD\_WITH\_FIXED\_CPP\_DEBUG}}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ \ \ \ \ cerr<<\textcolor{stringliteral}{"{}Error:\ Other."{}}<<endl;}
\DoxyCodeLine{00272\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00273\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00275\ \ \ \ \ \ \ \ \ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_adf555171e037b12e5177ebd81fd33de5}{solver\_type}}\ =\ \mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data}{min\_quad\_with\_fixed\_data<T>::LDLT}};}
\DoxyCodeLine{00276\ \ \ \ \ \ \ \}\textcolor{keywordflow}{else}}
\DoxyCodeLine{00277\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00278\ \textcolor{preprocessor}{\#ifdef\ MIN\_QUAD\_WITH\_FIXED\_CPP\_DEBUG}}
\DoxyCodeLine{00279\ \ \ \ \ cout<<\textcolor{stringliteral}{"{}\ \ \ \ lu"{}}<<endl;}
\DoxyCodeLine{00280\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00281\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Resort\ to\ LU}}
\DoxyCodeLine{00282\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Bottleneck\ >1/2}}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \ \ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a7c60ca349277d0e6e85e5cdd489e5dc2}{lu}}.compute(NA);}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ \textcolor{comment}{//std::cout<<"{}NA=["{}<<std::endl<<NA<<std::endl<<"{}];"{}<<std::endl;}}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}(data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a7c60ca349277d0e6e85e5cdd489e5dc2}{lu}}.info())}
\DoxyCodeLine{00286\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00287\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Eigen::Success:}
\DoxyCodeLine{00288\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Eigen::NumericalIssue:}
\DoxyCodeLine{00290\ \textcolor{preprocessor}{\#ifdef\ MIN\_QUAD\_WITH\_FIXED\_CPP\_DEBUG}}
\DoxyCodeLine{00291\ \ \ \ \ \ \ \ \ \ \ \ \ cerr<<\textcolor{stringliteral}{"{}Error:\ Numerical\ issue."{}}<<endl;}
\DoxyCodeLine{00292\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00293\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00294\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Eigen::InvalidInput:}
\DoxyCodeLine{00295\ \textcolor{preprocessor}{\#ifdef\ MIN\_QUAD\_WITH\_FIXED\_CPP\_DEBUG}}
\DoxyCodeLine{00296\ \ \ \ \ \ \ \ \ \ \ \ \ cerr<<\textcolor{stringliteral}{"{}Error:\ Invalid\ Input."{}}<<endl;}
\DoxyCodeLine{00297\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00300\ \textcolor{preprocessor}{\#ifdef\ MIN\_QUAD\_WITH\_FIXED\_CPP\_DEBUG}}
\DoxyCodeLine{00301\ \ \ \ \ \ \ \ \ \ \ \ \ cerr<<\textcolor{stringliteral}{"{}Error:\ Other."{}}<<endl;}
\DoxyCodeLine{00302\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00304\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00305\ \ \ \ \ \ \ \ \ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_adf555171e037b12e5177ebd81fd33de5}{solver\_type}}\ =\ \mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data}{min\_quad\_with\_fixed\_data<T>::LU}};}
\DoxyCodeLine{00306\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00307\ \ \ \ \ \}}
\DoxyCodeLine{00308\ \ \ \}\textcolor{keywordflow}{else}}
\DoxyCodeLine{00309\ \ \ \{}
\DoxyCodeLine{00310\ \textcolor{preprocessor}{\#ifdef\ MIN\_QUAD\_WITH\_FIXED\_CPP\_DEBUG}}
\DoxyCodeLine{00311\ \ \ \ \ cout<<\textcolor{stringliteral}{"{}\ \ \ \ Aeq\_li=false"{}}<<endl;}
\DoxyCodeLine{00312\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00313\ \ \ \ \ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_abdd3d36254dbf348fb6296f80bb3eaa0}{neq}}\ =\ neq;}
\DoxyCodeLine{00314\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nu\ =\ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a45a26b0e5d41d28bfea348ee51f52e4b}{unknown}}.size();}
\DoxyCodeLine{00315\ \ \ \ \ \textcolor{comment}{//cout<<"{}nu:\ "{}<<nu<<endl;}}
\DoxyCodeLine{00316\ \ \ \ \ \textcolor{comment}{//cout<<"{}neq:\ "{}<<neq<<endl;}}
\DoxyCodeLine{00317\ \ \ \ \ \textcolor{comment}{//cout<<"{}nc:\ "{}<<nc<<endl;}}
\DoxyCodeLine{00318\ \ \ \ \ \textcolor{comment}{//cout<<"{}\ \ \ \ matrixR"{}<<endl;}}
\DoxyCodeLine{00319\ \ \ \ \ SparseMatrix<T>\ AeqTR,AeqTQ;}
\DoxyCodeLine{00320\ \ \ \ \ AeqTR\ =\ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a0dd37f713f6578dc75ab710458d4654c}{AeqTQR}}.matrixR();}
\DoxyCodeLine{00321\ \ \ \ \ \textcolor{comment}{//\ This\ shouldn't\ be\ necessary}}
\DoxyCodeLine{00322\ \ \ \ \ AeqTR.prune(\textcolor{keyword}{static\_cast<}T\textcolor{keyword}{>}(0.0));}
\DoxyCodeLine{00323\ \textcolor{preprocessor}{\#ifdef\ MIN\_QUAD\_WITH\_FIXED\_CPP\_DEBUG}}
\DoxyCodeLine{00324\ \ \ \ \ cout<<\textcolor{stringliteral}{"{}\ \ \ \ matrixQ"{}}<<endl;}
\DoxyCodeLine{00325\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00326\ \ \ \ \ \textcolor{comment}{//\ THIS\ IS\ ESSENTIALLY\ DENSE\ AND\ THIS\ IS\ BY\ FAR\ THE\ BOTTLENECK}}
\DoxyCodeLine{00327\ \ \ \ \ \textcolor{comment}{//\ http://forum.kde.org/viewtopic.php?f=74\&t=117500}}
\DoxyCodeLine{00328\ \ \ \ \ AeqTQ\ =\ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a0dd37f713f6578dc75ab710458d4654c}{AeqTQR}}.matrixQ();}
\DoxyCodeLine{00329\ \textcolor{preprocessor}{\#ifdef\ MIN\_QUAD\_WITH\_FIXED\_CPP\_DEBUG}}
\DoxyCodeLine{00330\ \ \ \ \ cout<<\textcolor{stringliteral}{"{}\ \ \ \ prune"{}}<<endl;}
\DoxyCodeLine{00331\ \ \ \ \ cout<<\textcolor{stringliteral}{"{}\ \ \ \ \ \ nnz:\ "{}}<<AeqTQ.nonZeros()<<endl;}
\DoxyCodeLine{00332\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00333\ \ \ \ \ \textcolor{comment}{//\ This\ shouldn't\ be\ necessary}}
\DoxyCodeLine{00334\ \ \ \ \ AeqTQ.prune(\textcolor{keyword}{static\_cast<}T\textcolor{keyword}{>}(0.0));}
\DoxyCodeLine{00335\ \ \ \ \ \textcolor{comment}{//cout<<"{}AeqTQ:\ "{}<<AeqTQ.rows()<<"{}\ "{}<<AeqTQ.cols()<<endl;}}
\DoxyCodeLine{00336\ \ \ \ \ \textcolor{comment}{//cout<<matlab\_format(AeqTQ,"{}AeqTQ"{})<<endl;}}
\DoxyCodeLine{00337\ \ \ \ \ \textcolor{comment}{//cout<<"{}\ \ \ \ perms"{}<<endl;}}
\DoxyCodeLine{00338\ \textcolor{preprocessor}{\#ifdef\ MIN\_QUAD\_WITH\_FIXED\_CPP\_DEBUG}}
\DoxyCodeLine{00339\ \ \ \ \ cout<<\textcolor{stringliteral}{"{}\ \ \ \ \ \ nnz:\ "{}}<<AeqTQ.nonZeros()<<endl;}
\DoxyCodeLine{00340\ \ \ \ \ cout<<\textcolor{stringliteral}{"{}\ \ \ \ perm"{}}<<endl;}
\DoxyCodeLine{00341\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00342\ \ \ \ \ SparseMatrix<T>\ I(neq,neq);}
\DoxyCodeLine{00343\ \ \ \ \ I.setIdentity();}
\DoxyCodeLine{00344\ \ \ \ \ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_aeedc9f4d675bbd636b1782a75d0bbef3}{AeqTE}}\ =\ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a0dd37f713f6578dc75ab710458d4654c}{AeqTQR}}.colsPermutation()\ *\ I;}
\DoxyCodeLine{00345\ \ \ \ \ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_acabf6c24ee8ff41b8e536923a48c7395}{AeqTET}}\ =\ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a0dd37f713f6578dc75ab710458d4654c}{AeqTQR}}.colsPermutation().transpose()\ *\ I;}
\DoxyCodeLine{00346\ \ \ \ \ assert(AeqTR.rows()\ ==\ nu\ \ \ \&\&\ \textcolor{stringliteral}{"{}\#rows\ in\ AeqTR\ should\ match\ \#unknowns"{}});}
\DoxyCodeLine{00347\ \ \ \ \ assert(AeqTR.cols()\ ==\ neq\ \ \&\&\ \textcolor{stringliteral}{"{}\#cols\ in\ AeqTR\ should\ match\ \#constraints"{}});}
\DoxyCodeLine{00348\ \ \ \ \ assert(AeqTQ.rows()\ ==\ nu\ \&\&\ \textcolor{stringliteral}{"{}\#rows\ in\ AeqTQ\ should\ match\ \#unknowns"{}});}
\DoxyCodeLine{00349\ \ \ \ \ assert(AeqTQ.cols()\ ==\ nu\ \&\&\ \textcolor{stringliteral}{"{}\#cols\ in\ AeqTQ\ should\ match\ \#unknowns"{}});}
\DoxyCodeLine{00350\ \ \ \ \ \textcolor{comment}{//cout<<"{}\ \ \ \ slice"{}<<endl;}}
\DoxyCodeLine{00351\ \textcolor{preprocessor}{\#ifdef\ MIN\_QUAD\_WITH\_FIXED\_CPP\_DEBUG}}
\DoxyCodeLine{00352\ \ \ \ \ cout<<\textcolor{stringliteral}{"{}\ \ \ \ slice"{}}<<endl;}
\DoxyCodeLine{00353\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00354\ \ \ \ \ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a6dd70a80c9696cbd95cc4a11413caa8e}{AeqTQ1}}\ =\ AeqTQ.topLeftCorner(nu,nc);}
\DoxyCodeLine{00355\ \ \ \ \ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_af29f3f637f6a03ece40aa8c4811ad6f0}{AeqTQ1T}}\ =\ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a6dd70a80c9696cbd95cc4a11413caa8e}{AeqTQ1}}.transpose().eval();}
\DoxyCodeLine{00356\ \ \ \ \ \textcolor{comment}{//\ ALREADY\ TRIM\ (Not\ 100\%\ sure\ about\ this)}}
\DoxyCodeLine{00357\ \ \ \ \ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_abe2e974252d7deadea02f19093374781}{AeqTR1}}\ =\ AeqTR.topLeftCorner(nc,nc);}
\DoxyCodeLine{00358\ \ \ \ \ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_ad67e1f780d301ce6928c4bcf60563288}{AeqTR1T}}\ =\ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_abe2e974252d7deadea02f19093374781}{AeqTR1}}.transpose().eval();}
\DoxyCodeLine{00359\ \ \ \ \ \textcolor{comment}{//cout<<"{}AeqTR1T.size()\ "{}<<data.AeqTR1T.rows()<<"{}\ "{}<<data.AeqTR1T.cols()<<endl;}}
\DoxyCodeLine{00360\ \ \ \ \ \textcolor{comment}{//\ Null\ space}}
\DoxyCodeLine{00361\ \ \ \ \ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a65ebbedaafb67501de8a7cb0798b70ab}{AeqTQ2}}\ =\ AeqTQ.bottomRightCorner(nu,nu-\/nc);}
\DoxyCodeLine{00362\ \ \ \ \ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_ada118a14cca10b66554139cc28883b49}{AeqTQ2T}}\ =\ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a65ebbedaafb67501de8a7cb0798b70ab}{AeqTQ2}}.transpose().eval();}
\DoxyCodeLine{00363\ \textcolor{preprocessor}{\#ifdef\ MIN\_QUAD\_WITH\_FIXED\_CPP\_DEBUG}}
\DoxyCodeLine{00364\ \ \ \ \ cout<<\textcolor{stringliteral}{"{}\ \ \ \ proj"{}}<<endl;}
\DoxyCodeLine{00365\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00366\ \ \ \ \ \textcolor{comment}{//\ Projected\ hessian}}
\DoxyCodeLine{00367\ \ \ \ \ SparseMatrix<T>\ QRAuu\ =\ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_ada118a14cca10b66554139cc28883b49}{AeqTQ2T}}\ *\ Auu\ *\ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a65ebbedaafb67501de8a7cb0798b70ab}{AeqTQ2}};}
\DoxyCodeLine{00368\ \ \ \ \ \{}
\DoxyCodeLine{00369\ \textcolor{preprocessor}{\#ifdef\ MIN\_QUAD\_WITH\_FIXED\_CPP\_DEBUG}}
\DoxyCodeLine{00370\ \ \ \ \ \ \ cout<<\textcolor{stringliteral}{"{}\ \ \ \ factorize"{}}<<endl;}
\DoxyCodeLine{00371\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \textcolor{comment}{//\ QRAuu\ should\ always\ be\ PD}}
\DoxyCodeLine{00373\ \ \ \ \ \ \ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a4ef765c434c7997a24378788a7fd9c84}{llt}}.compute(QRAuu);}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}(data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a4ef765c434c7997a24378788a7fd9c84}{llt}}.info())}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Eigen::Success:}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Eigen::NumericalIssue:}
\DoxyCodeLine{00379\ \textcolor{preprocessor}{\#ifdef\ MIN\_QUAD\_WITH\_FIXED\_CPP\_DEBUG}}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ \ \ cerr<<\textcolor{stringliteral}{"{}Error:\ Numerical\ issue."{}}<<endl;}
\DoxyCodeLine{00381\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00384\ \textcolor{preprocessor}{\#ifdef\ MIN\_QUAD\_WITH\_FIXED\_CPP\_DEBUG}}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ \ \ cerr<<\textcolor{stringliteral}{"{}Error:\ Other."{}}<<endl;}
\DoxyCodeLine{00386\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00389\ \ \ \ \ \ \ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_adf555171e037b12e5177ebd81fd33de5}{solver\_type}}\ =\ \mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data}{min\_quad\_with\_fixed\_data<T>::QR\_LLT}};}
\DoxyCodeLine{00390\ \ \ \ \ \}}
\DoxyCodeLine{00391\ \textcolor{preprocessor}{\#ifdef\ MIN\_QUAD\_WITH\_FIXED\_CPP\_DEBUG}}
\DoxyCodeLine{00392\ \ \ \ \ cout<<\textcolor{stringliteral}{"{}\ \ \ \ smash"{}}<<endl;}
\DoxyCodeLine{00393\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00394\ \ \ \ \ \textcolor{comment}{//\ Known\ value\ multiplier}}
\DoxyCodeLine{00395\ \ \ \ \ SparseMatrix<T>\ Auk;}
\DoxyCodeLine{00396\ \ \ \ \ \mbox{\hyperlink{namespaceigl_a547a8704200d3af48fe92105c15a32ad}{slice}}(A,data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a45a26b0e5d41d28bfea348ee51f52e4b}{unknown}},data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a0b135eb50ef96353f9959dbfdc4e9844}{known}},Auk);}
\DoxyCodeLine{00397\ \ \ \ \ SparseMatrix<T>\ Aku;}
\DoxyCodeLine{00398\ \ \ \ \ \mbox{\hyperlink{namespaceigl_a547a8704200d3af48fe92105c15a32ad}{slice}}(A,data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a0b135eb50ef96353f9959dbfdc4e9844}{known}},data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a45a26b0e5d41d28bfea348ee51f52e4b}{unknown}},Aku);}
\DoxyCodeLine{00399\ \ \ \ \ SparseMatrix<T>\ AkuT\ =\ Aku.transpose();}
\DoxyCodeLine{00400\ \ \ \ \ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a3db371095ff5ecf7dc8c42c3e34a3695}{preY}}\ =\ Auk\ +\ AkuT;}
\DoxyCodeLine{00401\ \ \ \ \ \textcolor{comment}{//\ Needed\ during\ solve}}
\DoxyCodeLine{00402\ \ \ \ \ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_adde8448b08fd094fb92f2638ae476814}{Auu}}\ =\ Auu;}
\DoxyCodeLine{00403\ \ \ \ \ \mbox{\hyperlink{namespaceigl_a547a8704200d3af48fe92105c15a32ad}{slice}}(Aeq,data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a0b135eb50ef96353f9959dbfdc4e9844}{known}},2,data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_add2a92c1b4fb911ff47f193b37650afa}{Aeqk}});}
\DoxyCodeLine{00404\ \ \ \ \ assert(data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_add2a92c1b4fb911ff47f193b37650afa}{Aeqk}}.rows()\ ==\ neq);}
\DoxyCodeLine{00405\ \ \ \ \ assert(data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_add2a92c1b4fb911ff47f193b37650afa}{Aeqk}}.cols()\ ==\ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a0b135eb50ef96353f9959dbfdc4e9844}{known}}.size());}
\DoxyCodeLine{00406\ \ \ \}}
\DoxyCodeLine{00407\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00408\ \}}
\DoxyCodeLine{00409\ }
\DoxyCodeLine{00410\ }
\DoxyCodeLine{00411\ \textcolor{keyword}{template}\ <}
\DoxyCodeLine{00412\ \ \ \textcolor{keyword}{typename}\ T,}
\DoxyCodeLine{00413\ \ \ \textcolor{keyword}{typename}\ DerivedB,}
\DoxyCodeLine{00414\ \ \ \textcolor{keyword}{typename}\ DerivedY,}
\DoxyCodeLine{00415\ \ \ \textcolor{keyword}{typename}\ DerivedBeq,}
\DoxyCodeLine{00416\ \ \ \textcolor{keyword}{typename}\ DerivedZ,}
\DoxyCodeLine{00417\ \ \ \textcolor{keyword}{typename}\ Derivedsol>}
\DoxyCodeLine{00418\ \mbox{\hyperlink{igl__inline_8h_a838241279013352686271b4c4ce1f708}{IGL\_INLINE}}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespaceigl_ad6d436a09a132f780d5e503b39499fbb}{igl::min\_quad\_with\_fixed\_solve}}(}
\DoxyCodeLine{00419\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data}{min\_quad\_with\_fixed\_data<T>}}\ \&\ data,}
\DoxyCodeLine{00420\ \ \ \textcolor{keyword}{const}\ Eigen::MatrixBase<DerivedB>\ \&\ B,}
\DoxyCodeLine{00421\ \ \ \textcolor{keyword}{const}\ Eigen::MatrixBase<DerivedY>\ \&\ Y,}
\DoxyCodeLine{00422\ \ \ \textcolor{keyword}{const}\ Eigen::MatrixBase<DerivedBeq>\ \&\ Beq,}
\DoxyCodeLine{00423\ \ \ Eigen::PlainObjectBase<DerivedZ>\ \&\ Z,}
\DoxyCodeLine{00424\ \ \ Eigen::PlainObjectBase<Derivedsol>\ \&\ sol)}
\DoxyCodeLine{00425\ \{}
\DoxyCodeLine{00426\ \ \ \textcolor{keyword}{using\ namespace\ }std;}
\DoxyCodeLine{00427\ \ \ \textcolor{keyword}{using\ namespace\ }Eigen;}
\DoxyCodeLine{00428\ \ \ \textcolor{keyword}{typedef}\ Matrix<T,Dynamic,Dynamic>\ MatrixXT;}
\DoxyCodeLine{00429\ \ \ \textcolor{comment}{//\ number\ of\ known\ rows}}
\DoxyCodeLine{00430\ \ \ \textcolor{keywordtype}{int}\ kr\ =\ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a0b135eb50ef96353f9959dbfdc4e9844}{known}}.size();}
\DoxyCodeLine{00431\ \ \ \textcolor{keywordflow}{if}(kr!=0)}
\DoxyCodeLine{00432\ \ \ \{}
\DoxyCodeLine{00433\ \ \ \ \ assert(kr\ ==\ Y.rows());}
\DoxyCodeLine{00434\ \ \ \}}
\DoxyCodeLine{00435\ \ \ \textcolor{comment}{//\ number\ of\ columns\ to\ solve}}
\DoxyCodeLine{00436\ \ \ \textcolor{keywordtype}{int}\ cols\ =\ Y.cols();}
\DoxyCodeLine{00437\ \ \ assert(B.cols()\ ==\ 1\ ||\ B.cols()\ ==\ cols);}
\DoxyCodeLine{00438\ \ \ assert(Beq.size()\ ==\ 0\ ||\ Beq.cols()\ ==\ 1\ ||\ Beq.cols()\ ==\ cols);}
\DoxyCodeLine{00439\ }
\DoxyCodeLine{00440\ \ \ \textcolor{comment}{//\ resize\ output}}
\DoxyCodeLine{00441\ \ \ Z.resize(data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_aa2f79821dd5f69c2c704d4f8d2e0c34d}{n}},cols);}
\DoxyCodeLine{00442\ \ \ \textcolor{comment}{//\ Set\ known\ values}}
\DoxyCodeLine{00443\ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;i\ <\ kr;i++)}
\DoxyCodeLine{00444\ \ \ \{}
\DoxyCodeLine{00445\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j\ =\ 0;j\ <\ cols;j++)}
\DoxyCodeLine{00446\ \ \ \ \ \{}
\DoxyCodeLine{00447\ \ \ \ \ \ \ Z(data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a0b135eb50ef96353f9959dbfdc4e9844}{known}}(i),j)\ =\ Y(i,j);}
\DoxyCodeLine{00448\ \ \ \ \ \}}
\DoxyCodeLine{00449\ \ \ \}}
\DoxyCodeLine{00450\ }
\DoxyCodeLine{00451\ \ \ \textcolor{keywordflow}{if}(data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_aae738302bbd952761f3e48fcaa1b11f9}{Aeq\_li}})}
\DoxyCodeLine{00452\ \ \ \{}
\DoxyCodeLine{00453\ \ \ \ \ \textcolor{comment}{//\ number\ of\ lagrange\ multipliers\ aka\ linear\ equality\ constraints}}
\DoxyCodeLine{00454\ \ \ \ \ \textcolor{keywordtype}{int}\ neq\ =\ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_ab07863971db161e5eb7cdf2ec28afb06}{lagrange}}.size();}
\DoxyCodeLine{00455\ \ \ \ \ \textcolor{comment}{//\ append\ lagrange\ multiplier\ rhs's}}
\DoxyCodeLine{00456\ \ \ \ \ MatrixXT\ BBeq(B.rows()\ +\ Beq.rows(),cols);}
\DoxyCodeLine{00457\ \ \ \ \ \textcolor{keywordflow}{if}(B.size()\ >\ 0)}
\DoxyCodeLine{00458\ \ \ \ \ \{}
\DoxyCodeLine{00459\ \ \ \ \ \ \ BBeq.topLeftCorner(B.rows(),cols)\ =\ B.replicate(1,B.cols()==cols?1:cols);}
\DoxyCodeLine{00460\ \ \ \ \ \}}
\DoxyCodeLine{00461\ \ \ \ \ \textcolor{keywordflow}{if}(Beq.size()\ >\ 0)}
\DoxyCodeLine{00462\ \ \ \ \ \{}
\DoxyCodeLine{00463\ \ \ \ \ \ \ BBeq.bottomLeftCorner(Beq.rows(),cols)\ =\ -\/2.0*Beq.replicate(1,Beq.cols()==cols?1:cols);}
\DoxyCodeLine{00464\ \ \ \ \ \}}
\DoxyCodeLine{00465\ }
\DoxyCodeLine{00466\ \ \ \ \ \textcolor{comment}{//\ Build\ right\ hand\ side}}
\DoxyCodeLine{00467\ \ \ \ \ MatrixXT\ BBequlcols\ =\ BBeq(data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_ac680271bddf24abc8337ca15965a200d}{unknown\_lagrange}},Eigen::all);}
\DoxyCodeLine{00468\ \ \ \ \ MatrixXT\ NB;}
\DoxyCodeLine{00469\ \ \ \ \ \textcolor{keywordflow}{if}(kr\ ==\ 0)}
\DoxyCodeLine{00470\ \ \ \ \ \{}
\DoxyCodeLine{00471\ \ \ \ \ \ \ NB\ =\ BBequlcols;}
\DoxyCodeLine{00472\ \ \ \ \ \}\textcolor{keywordflow}{else}}
\DoxyCodeLine{00473\ \ \ \ \ \{}
\DoxyCodeLine{00474\ \ \ \ \ \ \ NB\ =\ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a3db371095ff5ecf7dc8c42c3e34a3695}{preY}}\ *\ Y\ +\ BBequlcols;}
\DoxyCodeLine{00475\ \ \ \ \ \}}
\DoxyCodeLine{00476\ }
\DoxyCodeLine{00477\ \ \ \ \ \textcolor{comment}{//std::cout<<"{}NB=["{}<<std::endl<<NB<<std::endl<<"{}];"{}<<std::endl;}}
\DoxyCodeLine{00478\ \ \ \ \ \textcolor{comment}{//cout<<matlab\_format(NB,"{}NB"{})<<endl;}}
\DoxyCodeLine{00479\ \ \ \ \ \textcolor{keywordflow}{switch}(data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_adf555171e037b12e5177ebd81fd33de5}{solver\_type}})}
\DoxyCodeLine{00480\ \ \ \ \ \{}
\DoxyCodeLine{00481\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data}{igl::min\_quad\_with\_fixed\_data<T>::LLT}}:}
\DoxyCodeLine{00482\ \ \ \ \ \ \ \ \ sol\ =\ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a4ef765c434c7997a24378788a7fd9c84}{llt}}.solve(NB);}
\DoxyCodeLine{00483\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00484\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data}{igl::min\_quad\_with\_fixed\_data<T>::LDLT}}:}
\DoxyCodeLine{00485\ \ \ \ \ \ \ \ \ sol\ =\ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a1bd2d40db9381b99df7cafafa3e9b8ac}{ldlt}}.solve(NB);}
\DoxyCodeLine{00486\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00487\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data}{igl::min\_quad\_with\_fixed\_data<T>::LU}}:}
\DoxyCodeLine{00488\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Not\ a\ bottleneck}}
\DoxyCodeLine{00489\ \ \ \ \ \ \ \ \ sol\ =\ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a7c60ca349277d0e6e85e5cdd489e5dc2}{lu}}.solve(NB);}
\DoxyCodeLine{00490\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00491\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00492\ \textcolor{preprocessor}{\#ifdef\ MIN\_QUAD\_WITH\_FIXED\_CPP\_DEBUG}}
\DoxyCodeLine{00493\ \ \ \ \ \ \ \ \ cerr<<\textcolor{stringliteral}{"{}Error:\ invalid\ solver\ type"{}}<<endl;}
\DoxyCodeLine{00494\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00495\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00496\ \ \ \ \ \}}
\DoxyCodeLine{00497\ \ \ \ \ \textcolor{comment}{//std::cout<<"{}sol=["{}<<std::endl<<sol<<std::endl<<"{}];"{}<<std::endl;}}
\DoxyCodeLine{00498\ \ \ \ \ \textcolor{comment}{//\ Now\ sol\ contains\ sol/-\/0.5}}
\DoxyCodeLine{00499\ \ \ \ \ sol\ *=\ -\/0.5;}
\DoxyCodeLine{00500\ \ \ \ \ \textcolor{comment}{//\ Now\ sol\ contains\ solution}}
\DoxyCodeLine{00501\ \ \ \ \ \textcolor{comment}{//\ Place\ solution\ in\ Z}}
\DoxyCodeLine{00502\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;i<(sol.rows()-\/neq);i++)}
\DoxyCodeLine{00503\ \ \ \ \ \{}
\DoxyCodeLine{00504\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j\ =\ 0;j<sol.cols();j++)}
\DoxyCodeLine{00505\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00506\ \ \ \ \ \ \ \ \ Z(data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_ac680271bddf24abc8337ca15965a200d}{unknown\_lagrange}}(i),j)\ =\ sol(i,j);}
\DoxyCodeLine{00507\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00508\ \ \ \ \ \}}
\DoxyCodeLine{00509\ \ \ \}\textcolor{keywordflow}{else}}
\DoxyCodeLine{00510\ \ \ \{}
\DoxyCodeLine{00511\ \ \ \ \ assert(data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_adf555171e037b12e5177ebd81fd33de5}{solver\_type}}\ ==\ \mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data}{min\_quad\_with\_fixed\_data<T>::QR\_LLT}});}
\DoxyCodeLine{00512\ \ \ \ \ MatrixXT\ eff\_Beq;}
\DoxyCodeLine{00513\ \ \ \ \ \textcolor{comment}{//\ Adjust\ Aeq\ rhs\ to\ include\ known\ parts}}
\DoxyCodeLine{00514\ \ \ \ \ eff\_Beq\ =}
\DoxyCodeLine{00515\ \ \ \ \ \ \ \textcolor{comment}{//data.AeqTQR.colsPermutation().transpose()\ *\ (-\/data.Aeqk\ *\ Y\ +\ Beq);}}
\DoxyCodeLine{00516\ \ \ \ \ \ \ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_acabf6c24ee8ff41b8e536923a48c7395}{AeqTET}}\ *\ (-\/data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_add2a92c1b4fb911ff47f193b37650afa}{Aeqk}}\ *\ Y\ +\ Beq.replicate(1,Beq.cols()==cols?1:cols));}
\DoxyCodeLine{00517\ \ \ \ \ \textcolor{comment}{//\ Where\ did\ this\ -\/0.5\ come\ from?\ Probably\ the\ same\ place\ as\ above.}}
\DoxyCodeLine{00518\ \ \ \ \ MatrixXT\ Bu\ =\ B(data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a45a26b0e5d41d28bfea348ee51f52e4b}{unknown}},Eigen::all);}
\DoxyCodeLine{00519\ \ \ \ \ MatrixXT\ NB;}
\DoxyCodeLine{00520\ \ \ \ \ NB\ =\ -\/0.5*(Bu.replicate(1,B.cols()==cols?1:cols)\ +\ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a3db371095ff5ecf7dc8c42c3e34a3695}{preY}}\ *\ Y);}
\DoxyCodeLine{00521\ \ \ \ \ \textcolor{comment}{//\ Trim\ eff\_Beq}}
\DoxyCodeLine{00522\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nc\ =\ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a0dd37f713f6578dc75ab710458d4654c}{AeqTQR}}.rank();}
\DoxyCodeLine{00523\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ neq\ =\ Beq.rows();}
\DoxyCodeLine{00524\ \ \ \ \ eff\_Beq\ =\ eff\_Beq.topLeftCorner(nc,cols).eval();}
\DoxyCodeLine{00525\ \ \ \ \ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_ad67e1f780d301ce6928c4bcf60563288}{AeqTR1T}}.template\ triangularView<Lower>().solveInPlace(eff\_Beq);}
\DoxyCodeLine{00526\ \ \ \ \ \textcolor{comment}{//\ Now\ eff\_Beq\ =\ (data.AeqTR1T\ \(\backslash\)\ (data.AeqTET\ *\ (-\/data.Aeqk\ *\ Y\ +\ Beq)))}}
\DoxyCodeLine{00527\ \ \ \ \ MatrixXT\ lambda\_0;}
\DoxyCodeLine{00528\ \ \ \ \ lambda\_0\ =\ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a6dd70a80c9696cbd95cc4a11413caa8e}{AeqTQ1}}\ *\ eff\_Beq;}
\DoxyCodeLine{00529\ \ \ \ \ \textcolor{comment}{//cout<<matlab\_format(lambda\_0,"{}lambda\_0"{})<<endl;}}
\DoxyCodeLine{00530\ \ \ \ \ MatrixXT\ QRB;}
\DoxyCodeLine{00531\ \ \ \ \ QRB\ =\ -\/data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_ada118a14cca10b66554139cc28883b49}{AeqTQ2T}}\ *\ (data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_adde8448b08fd094fb92f2638ae476814}{Auu}}\ *\ lambda\_0)\ +\ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_ada118a14cca10b66554139cc28883b49}{AeqTQ2T}}\ *\ NB;}
\DoxyCodeLine{00532\ \ \ \ \ Derivedsol\ lambda;}
\DoxyCodeLine{00533\ \ \ \ \ lambda\ =\ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a4ef765c434c7997a24378788a7fd9c84}{llt}}.solve(QRB);}
\DoxyCodeLine{00534\ \ \ \ \ \textcolor{comment}{//\ prepare\ output}}
\DoxyCodeLine{00535\ \ \ \ \ Derivedsol\ solu;}
\DoxyCodeLine{00536\ \ \ \ \ solu\ =\ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a65ebbedaafb67501de8a7cb0798b70ab}{AeqTQ2}}\ *\ lambda\ +\ lambda\_0;}
\DoxyCodeLine{00537\ \ \ \ \ \textcolor{comment}{//\ \ http://www.math.uh.edu/\string~rohop/fall\_06/Chapter3.pdf}}
\DoxyCodeLine{00538\ \ \ \ \ Derivedsol\ solLambda;}
\DoxyCodeLine{00539\ \ \ \ \ \{}
\DoxyCodeLine{00540\ \ \ \ \ \ \ Derivedsol\ temp1,temp2;}
\DoxyCodeLine{00541\ \ \ \ \ \ \ temp1\ =\ (data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_af29f3f637f6a03ece40aa8c4811ad6f0}{AeqTQ1T}}\ *\ NB\ -\/\ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_af29f3f637f6a03ece40aa8c4811ad6f0}{AeqTQ1T}}\ *\ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_adde8448b08fd094fb92f2638ae476814}{Auu}}\ *\ solu);}
\DoxyCodeLine{00542\ \ \ \ \ \ \ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_abe2e974252d7deadea02f19093374781}{AeqTR1}}.template\ triangularView<Upper>().solveInPlace(temp1);}
\DoxyCodeLine{00543\ \ \ \ \ \ \ \textcolor{comment}{//cout<<matlab\_format(temp1,"{}temp1"{})<<endl;}}
\DoxyCodeLine{00544\ \ \ \ \ \ \ temp2\ =\ Derivedsol::Zero(neq,cols);}
\DoxyCodeLine{00545\ \ \ \ \ \ \ temp2.topLeftCorner(nc,cols)\ =\ temp1;}
\DoxyCodeLine{00546\ \ \ \ \ \ \ \textcolor{comment}{//solLambda\ =\ data.AeqTQR.colsPermutation()\ *\ temp2;}}
\DoxyCodeLine{00547\ \ \ \ \ \ \ solLambda\ =\ data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_aeedc9f4d675bbd636b1782a75d0bbef3}{AeqTE}}\ *\ temp2;}
\DoxyCodeLine{00548\ \ \ \ \ \}}
\DoxyCodeLine{00549\ \ \ \ \ \textcolor{comment}{//\ sol\ is\ [Z(unknown);Lambda]}}
\DoxyCodeLine{00550\ \ \ \ \ assert(data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a45a26b0e5d41d28bfea348ee51f52e4b}{unknown}}.size()\ ==\ solu.rows());}
\DoxyCodeLine{00551\ \ \ \ \ assert(cols\ ==\ solu.cols());}
\DoxyCodeLine{00552\ \ \ \ \ assert(data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_abdd3d36254dbf348fb6296f80bb3eaa0}{neq}}\ ==\ neq);}
\DoxyCodeLine{00553\ \ \ \ \ assert(data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_abdd3d36254dbf348fb6296f80bb3eaa0}{neq}}\ ==\ solLambda.rows());}
\DoxyCodeLine{00554\ \ \ \ \ assert(cols\ ==\ solLambda.cols());}
\DoxyCodeLine{00555\ \ \ \ \ sol.resize(data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a45a26b0e5d41d28bfea348ee51f52e4b}{unknown}}.size()+data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_abdd3d36254dbf348fb6296f80bb3eaa0}{neq}},cols);}
\DoxyCodeLine{00556\ \ \ \ \ sol.block(0,0,solu.rows(),solu.cols())\ =\ solu;}
\DoxyCodeLine{00557\ \ \ \ \ sol.block(solu.rows(),0,solLambda.rows(),solLambda.cols())\ =\ solLambda;}
\DoxyCodeLine{00558\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ u\ =\ 0;u<data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a45a26b0e5d41d28bfea348ee51f52e4b}{unknown}}.size();u++)}
\DoxyCodeLine{00559\ \ \ \ \ \{}
\DoxyCodeLine{00560\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j\ =\ 0;j<Z.cols();j++)}
\DoxyCodeLine{00561\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00562\ \ \ \ \ \ \ \ \ Z(data.\mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data_a45a26b0e5d41d28bfea348ee51f52e4b}{unknown}}(u),j)\ =\ solu(u,j);}
\DoxyCodeLine{00563\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00564\ \ \ \ \ \}}
\DoxyCodeLine{00565\ \ \ \}}
\DoxyCodeLine{00566\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00567\ \}}
\DoxyCodeLine{00568\ }
\DoxyCodeLine{00569\ \textcolor{keyword}{template}\ <}
\DoxyCodeLine{00570\ \ \ \textcolor{keyword}{typename}\ T,}
\DoxyCodeLine{00571\ \ \ \textcolor{keyword}{typename}\ DerivedB,}
\DoxyCodeLine{00572\ \ \ \textcolor{keyword}{typename}\ DerivedY,}
\DoxyCodeLine{00573\ \ \ \textcolor{keyword}{typename}\ DerivedBeq,}
\DoxyCodeLine{00574\ \ \ \textcolor{keyword}{typename}\ DerivedZ>}
\DoxyCodeLine{00575\ \mbox{\hyperlink{igl__inline_8h_a838241279013352686271b4c4ce1f708}{IGL\_INLINE}}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespaceigl_ad6d436a09a132f780d5e503b39499fbb}{igl::min\_quad\_with\_fixed\_solve}}(}
\DoxyCodeLine{00576\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data}{min\_quad\_with\_fixed\_data<T>}}\ \&\ data,}
\DoxyCodeLine{00577\ \ \ \textcolor{keyword}{const}\ Eigen::MatrixBase<DerivedB>\ \&\ B,}
\DoxyCodeLine{00578\ \ \ \textcolor{keyword}{const}\ Eigen::MatrixBase<DerivedY>\ \&\ Y,}
\DoxyCodeLine{00579\ \ \ \textcolor{keyword}{const}\ Eigen::MatrixBase<DerivedBeq>\ \&\ Beq,}
\DoxyCodeLine{00580\ \ \ Eigen::PlainObjectBase<DerivedZ>\ \&\ Z)}
\DoxyCodeLine{00581\ \{}
\DoxyCodeLine{00582\ \ \ Eigen::Matrix<typename\ DerivedZ::Scalar,\ Eigen::Dynamic,\ Eigen::Dynamic>\ sol;}
\DoxyCodeLine{00583\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespaceigl_ad6d436a09a132f780d5e503b39499fbb}{min\_quad\_with\_fixed\_solve}}(data,B,Y,Beq,Z,sol);}
\DoxyCodeLine{00584\ \}}
\DoxyCodeLine{00585\ }
\DoxyCodeLine{00586\ \textcolor{keyword}{template}\ <}
\DoxyCodeLine{00587\ \ \ \textcolor{keyword}{typename}\ T,}
\DoxyCodeLine{00588\ \ \ \textcolor{keyword}{typename}\ Derivedknown,}
\DoxyCodeLine{00589\ \ \ \textcolor{keyword}{typename}\ DerivedB,}
\DoxyCodeLine{00590\ \ \ \textcolor{keyword}{typename}\ DerivedY,}
\DoxyCodeLine{00591\ \ \ \textcolor{keyword}{typename}\ DerivedBeq,}
\DoxyCodeLine{00592\ \ \ \textcolor{keyword}{typename}\ DerivedZ>}
\DoxyCodeLine{00593\ \mbox{\hyperlink{igl__inline_8h_a838241279013352686271b4c4ce1f708}{IGL\_INLINE}}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespaceigl_abcdcf5c62d46412f4b5de5889e51c0d4}{igl::min\_quad\_with\_fixed}}(}
\DoxyCodeLine{00594\ \ \ \textcolor{keyword}{const}\ Eigen::SparseMatrix<T>\&\ A,}
\DoxyCodeLine{00595\ \ \ \textcolor{keyword}{const}\ Eigen::MatrixBase<DerivedB>\ \&\ B,}
\DoxyCodeLine{00596\ \ \ \textcolor{keyword}{const}\ Eigen::MatrixBase<Derivedknown>\ \&\ known,}
\DoxyCodeLine{00597\ \ \ \textcolor{keyword}{const}\ Eigen::MatrixBase<DerivedY>\ \&\ Y,}
\DoxyCodeLine{00598\ \ \ \textcolor{keyword}{const}\ Eigen::SparseMatrix<T>\&\ Aeq,}
\DoxyCodeLine{00599\ \ \ \textcolor{keyword}{const}\ Eigen::MatrixBase<DerivedBeq>\ \&\ Beq,}
\DoxyCodeLine{00600\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ pd,}
\DoxyCodeLine{00601\ \ \ Eigen::PlainObjectBase<DerivedZ>\ \&\ Z)}
\DoxyCodeLine{00602\ \{}
\DoxyCodeLine{00603\ \ \ \mbox{\hyperlink{structigl_1_1min__quad__with__fixed__data}{min\_quad\_with\_fixed\_data<T>}}\ data;}
\DoxyCodeLine{00604\ \ \ \textcolor{keywordflow}{if}(!\mbox{\hyperlink{namespaceigl_adc0382628e374a5b92a226ad75ce6b8b}{min\_quad\_with\_fixed\_precompute}}(A,known,Aeq,pd,data))}
\DoxyCodeLine{00605\ \ \ \{}
\DoxyCodeLine{00606\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00607\ \ \ \}}
\DoxyCodeLine{00608\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespaceigl_ad6d436a09a132f780d5e503b39499fbb}{min\_quad\_with\_fixed\_solve}}(data,B,Y,Beq,Z);}
\DoxyCodeLine{00609\ \}}
\DoxyCodeLine{00610\ }
\DoxyCodeLine{00611\ }
\DoxyCodeLine{00612\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Scalar,\ \textcolor{keywordtype}{int}\ n,\ \textcolor{keywordtype}{int}\ m,\ \textcolor{keywordtype}{bool}\ Hpd>}
\DoxyCodeLine{00613\ \mbox{\hyperlink{igl__inline_8h_a838241279013352686271b4c4ce1f708}{IGL\_INLINE}}\ Eigen::Matrix<Scalar,n,1>\ \mbox{\hyperlink{namespaceigl_abcdcf5c62d46412f4b5de5889e51c0d4}{igl::min\_quad\_with\_fixed}}(}
\DoxyCodeLine{00614\ \ \ \textcolor{keyword}{const}\ Eigen::Matrix<Scalar,n,n>\ \&\ H,}
\DoxyCodeLine{00615\ \ \ \textcolor{keyword}{const}\ Eigen::Matrix<Scalar,n,1>\ \&\ f,}
\DoxyCodeLine{00616\ \ \ \textcolor{keyword}{const}\ Eigen::Array<bool,n,1>\ \&\ k,}
\DoxyCodeLine{00617\ \ \ \textcolor{keyword}{const}\ Eigen::Matrix<Scalar,n,1>\ \&\ bc,}
\DoxyCodeLine{00618\ \ \ \textcolor{keyword}{const}\ Eigen::Matrix<Scalar,m,n>\ \&\ A,}
\DoxyCodeLine{00619\ \ \ \textcolor{keyword}{const}\ Eigen::Matrix<Scalar,m,1>\ \&\ b)}
\DoxyCodeLine{00620\ \{}
\DoxyCodeLine{00621\ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ dyn\_n\ =\ n\ ==\ Eigen::Dynamic\ ?\ H.rows()\ :\ n;}
\DoxyCodeLine{00622\ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ dyn\_m\ =\ m\ ==\ Eigen::Dynamic\ ?\ A.rows()\ :\ m;}
\DoxyCodeLine{00623\ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nn\ =\ n\ ==\ Eigen::Dynamic\ ?\ Eigen::Dynamic\ :\ n+m;}
\DoxyCodeLine{00624\ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ dyn\_nn\ =\ nn\ ==\ Eigen::Dynamic\ ?\ dyn\_n+dyn\_m\ :\ nn;}
\DoxyCodeLine{00625\ \ \ \textcolor{keywordflow}{if}(dyn\_m\ ==\ 0)}
\DoxyCodeLine{00626\ \ \ \{}
\DoxyCodeLine{00627\ \ \ \ \ \textcolor{keywordflow}{return}\ igl::min\_quad\_with\_fixed<Scalar,n,Hpd>(H,f,k,bc);}
\DoxyCodeLine{00628\ \ \ \}}
\DoxyCodeLine{00629\ \ \ \textcolor{comment}{//\ min\_x\ ½\ xᵀ\ H\ x\ +\ xᵀ\ f\ \ \ subject\ to\ A\ x\ =\ b\ and\ x(k)\ =\ bc(k)}}
\DoxyCodeLine{00630\ \ \ \textcolor{comment}{//\ let\ zᵀ\ =\ [xᵀ\ λᵀ]}}
\DoxyCodeLine{00631\ \ \ \textcolor{comment}{//\ min\_z\ ½\ zᵀ\ [H\ Aᵀ;A\ 0]\ z\ +\ zᵀ\ [f;-\/b]\ \ \ z(k)\ =\ bc(k)}}
\DoxyCodeLine{00632\ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ make\_HH\ =\ [\&]()}
\DoxyCodeLine{00633\ \ \ \{}
\DoxyCodeLine{00634\ \ \ \ \ \textcolor{comment}{//\ Windows\ can't\ remember\ that\ nn\ is\ const.}}
\DoxyCodeLine{00635\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nn\ =\ n\ ==\ Eigen::Dynamic\ ?\ Eigen::Dynamic\ :\ n+m;}
\DoxyCodeLine{00636\ \ \ \ \ Eigen::Matrix<Scalar,nn,nn>\ HH\ =}
\DoxyCodeLine{00637\ \ \ \ \ \ \ Eigen::Matrix<Scalar,nn,nn>::Zero(dyn\_nn,dyn\_nn);}
\DoxyCodeLine{00638\ \ \ \ \ HH.topLeftCorner(dyn\_n,dyn\_n)\ =\ H;}
\DoxyCodeLine{00639\ \ \ \ \ HH.bottomLeftCorner(dyn\_m,dyn\_n)\ =\ A;}
\DoxyCodeLine{00640\ \ \ \ \ HH.topRightCorner(dyn\_n,dyn\_m)\ =\ A.transpose();}
\DoxyCodeLine{00641\ \ \ \ \ \textcolor{keywordflow}{return}\ HH;}
\DoxyCodeLine{00642\ \ \ \};}
\DoxyCodeLine{00643\ \ \ \textcolor{keyword}{const}\ Eigen::Matrix<Scalar,nn,nn>\ HH\ =\ make\_HH();}
\DoxyCodeLine{00644\ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ make\_ff\ \ =\ [\&]()}
\DoxyCodeLine{00645\ \ \ \{}
\DoxyCodeLine{00646\ \ \ \ \ \textcolor{comment}{//\ Windows\ can't\ remember\ that\ nn\ is\ const.}}
\DoxyCodeLine{00647\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nn\ =\ n\ ==\ Eigen::Dynamic\ ?\ Eigen::Dynamic\ :\ n+m;}
\DoxyCodeLine{00648\ \ \ \ \ Eigen::Matrix<Scalar,nn,1>\ ff(dyn\_nn);}
\DoxyCodeLine{00649\ \ \ \ \ ff.head(dyn\_n)\ =\ \ f;}
\DoxyCodeLine{00650\ \ \ \ \ ff.tail(dyn\_m)\ =\ -\/b;}
\DoxyCodeLine{00651\ \ \ \ \ \textcolor{keywordflow}{return}\ ff;}
\DoxyCodeLine{00652\ \ \ \};}
\DoxyCodeLine{00653\ \ \ \textcolor{keyword}{const}\ Eigen::Matrix<Scalar,nn,1>\ ff\ =\ make\_ff();}
\DoxyCodeLine{00654\ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ make\_kk\ \ =\ [\&]()}
\DoxyCodeLine{00655\ \ \ \{}
\DoxyCodeLine{00656\ \ \ \ \ \textcolor{comment}{//\ Windows\ can't\ remember\ that\ nn\ is\ const.}}
\DoxyCodeLine{00657\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nn\ =\ n\ ==\ Eigen::Dynamic\ ?\ Eigen::Dynamic\ :\ n+m;}
\DoxyCodeLine{00658\ \ \ \ \ Eigen::Array<bool,nn,1>\ kk\ =}
\DoxyCodeLine{00659\ \ \ \ \ \ \ Eigen::Array<bool,nn,1>::Constant(dyn\_nn,1,\textcolor{keyword}{false});}
\DoxyCodeLine{00660\ \ \ \ \ kk.head(dyn\_n)\ =\ \ k;}
\DoxyCodeLine{00661\ \ \ \ \ \textcolor{keywordflow}{return}\ kk;}
\DoxyCodeLine{00662\ \ \ \};}
\DoxyCodeLine{00663\ \ \ \textcolor{keyword}{const}\ Eigen::Array<bool,nn,1>\ kk\ =\ make\_kk();}
\DoxyCodeLine{00664\ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ make\_bcbc=\ [\&]()}
\DoxyCodeLine{00665\ \ \ \{}
\DoxyCodeLine{00666\ \ \ \ \ \textcolor{comment}{//\ Windows\ can't\ remember\ that\ nn\ is\ const.}}
\DoxyCodeLine{00667\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nn\ =\ n\ ==\ Eigen::Dynamic\ ?\ Eigen::Dynamic\ :\ n+m;}
\DoxyCodeLine{00668\ \ \ \ \ Eigen::Matrix<Scalar,nn,1>\ bcbc(dyn\_nn);}
\DoxyCodeLine{00669\ \ \ \ \ bcbc.head(dyn\_n)\ =\ \ bc;}
\DoxyCodeLine{00670\ \ \ \ \ \textcolor{keywordflow}{return}\ bcbc;}
\DoxyCodeLine{00671\ \ \ \};}
\DoxyCodeLine{00672\ \ \ \textcolor{keyword}{const}\ Eigen::Matrix<Scalar,nn,1>\ bcbc\ =\ make\_bcbc();}
\DoxyCodeLine{00673\ \ \ \textcolor{keyword}{const}\ Eigen::Matrix<Scalar,nn,1>\ xx\ =}
\DoxyCodeLine{00674\ \ \ \ \ min\_quad\_with\_fixed<Scalar,nn,false>(HH,ff,kk,bcbc);}
\DoxyCodeLine{00675\ \ \ \textcolor{keywordflow}{return}\ xx.head(dyn\_n);}
\DoxyCodeLine{00676\ \}}
\DoxyCodeLine{00677\ }
\DoxyCodeLine{00678\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Scalar,\ \textcolor{keywordtype}{int}\ n,\ \textcolor{keywordtype}{bool}\ Hpd>}
\DoxyCodeLine{00679\ \mbox{\hyperlink{igl__inline_8h_a838241279013352686271b4c4ce1f708}{IGL\_INLINE}}\ Eigen::Matrix<Scalar,n,1>\ \mbox{\hyperlink{namespaceigl_abcdcf5c62d46412f4b5de5889e51c0d4}{igl::min\_quad\_with\_fixed}}(}
\DoxyCodeLine{00680\ \ \ \textcolor{keyword}{const}\ Eigen::Matrix<Scalar,n,n>\ \&\ H,}
\DoxyCodeLine{00681\ \ \ \textcolor{keyword}{const}\ Eigen::Matrix<Scalar,n,1>\ \&\ f,}
\DoxyCodeLine{00682\ \ \ \textcolor{keyword}{const}\ Eigen::Array<bool,n,1>\ \&\ k,}
\DoxyCodeLine{00683\ \ \ \textcolor{keyword}{const}\ Eigen::Matrix<Scalar,n,1>\ \&\ bc)}
\DoxyCodeLine{00684\ \{}
\DoxyCodeLine{00685\ \ \ assert(H.isApprox(H.transpose(),1e-\/7));}
\DoxyCodeLine{00686\ \ \ assert(H.rows()\ ==\ H.cols());}
\DoxyCodeLine{00687\ \ \ assert(H.rows()\ ==\ f.size());}
\DoxyCodeLine{00688\ \ \ assert(H.rows()\ ==\ k.size());}
\DoxyCodeLine{00689\ \ \ assert(H.rows()\ ==\ bc.size());}
\DoxyCodeLine{00690\ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ kcount\ =\ k.count();}
\DoxyCodeLine{00691\ \ \ \textcolor{comment}{//\ Everything\ fixed}}
\DoxyCodeLine{00692\ \ \ \textcolor{keywordflow}{if}(kcount\ ==\ (Eigen::Dynamic?H.rows():n))}
\DoxyCodeLine{00693\ \ \ \{}
\DoxyCodeLine{00694\ \ \ \ \ \textcolor{keywordflow}{return}\ bc;}
\DoxyCodeLine{00695\ \ \ \}}
\DoxyCodeLine{00696\ \ \ \textcolor{comment}{//\ Nothing\ fixed}}
\DoxyCodeLine{00697\ \ \ \textcolor{keywordflow}{if}(kcount\ ==\ 0)}
\DoxyCodeLine{00698\ \ \ \{}
\DoxyCodeLine{00699\ \ \ \ \ \textcolor{comment}{//\ avoid\ function\ call}}
\DoxyCodeLine{00700\ \ \ \ \ \textcolor{keyword}{typedef}\ Eigen::Matrix<Scalar,n,n>\ MatrixSn;}
\DoxyCodeLine{00701\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}}
\DoxyCodeLine{00702\ \ \ \ \ \ \ std::conditional<Hpd,Eigen::LLT<MatrixSn>,Eigen::CompleteOrthogonalDecomposition<MatrixSn>>::type}
\DoxyCodeLine{00703\ \ \ \ \ \ \ Solver;}
\DoxyCodeLine{00704\ \ \ \ \ \textcolor{keywordflow}{return}\ Solver(H).solve(-\/f);}
\DoxyCodeLine{00705\ \ \ \}}
\DoxyCodeLine{00706\ \ \ \textcolor{comment}{//\ All-\/but-\/one\ fixed}}
\DoxyCodeLine{00707\ \ \ \textcolor{keywordflow}{if}(\ (Eigen::Dynamic?H.rows():n)-\/kcount\ ==\ 1)}
\DoxyCodeLine{00708\ \ \ \{}
\DoxyCodeLine{00709\ \ \ \ \ \textcolor{comment}{//\ which\ one\ is\ not\ fixed?}}
\DoxyCodeLine{00710\ \ \ \ \ \textcolor{keywordtype}{int}\ u\ =\ -\/1;}
\DoxyCodeLine{00711\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i=0;i<k.size();i++)\{\ \textcolor{keywordflow}{if}(!k(i))\{\ u=i;\ \textcolor{keywordflow}{break};\ \}\ \}}
\DoxyCodeLine{00712\ \ \ \ \ assert(u>=0);}
\DoxyCodeLine{00713\ \ \ \ \ \textcolor{comment}{//\ min\ ½\ x(u)\ Huu\ x(u)\ +\ x(u)(fu\ +\ H(u,k)bc(k))}}
\DoxyCodeLine{00714\ \ \ \ \ \textcolor{comment}{//\ Huu\ x(u)\ =\ -\/(fu\ +\ H(u,k)\ bc(k))}}
\DoxyCodeLine{00715\ \ \ \ \ \textcolor{comment}{//\ x(u)\ =\ (-\/fu\ +\ ∑\ -\/Huj\ bcj)/Huu}}
\DoxyCodeLine{00716\ \ \ \ \ Eigen::Matrix<Scalar,n,1>\ x\ =\ bc;}
\DoxyCodeLine{00717\ \ \ \ \ x(u)\ =\ -\/f(u);}
\DoxyCodeLine{00718\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i=0;i<k.size();i++)\{\ \textcolor{keywordflow}{if}(i!=u)\{\ x(u)-\/=bc(i)*H(i,u);\ \}\ \}}
\DoxyCodeLine{00719\ \ \ \ \ x(u)\ /=\ H(u,u);}
\DoxyCodeLine{00720\ \ \ \ \ \textcolor{keywordflow}{return}\ x;}
\DoxyCodeLine{00721\ \ \ \}}
\DoxyCodeLine{00722\ \ \ \textcolor{comment}{//\ Alec:\ Is\ there\ a\ smart\ template\ way\ to\ do\ this?}}
\DoxyCodeLine{00723\ \ \ \textcolor{comment}{//\ jdumas:\ I\ guess\ you\ could\ do\ a\ templated\ for-\/loop\ starting\ from\ 16,\ and}}
\DoxyCodeLine{00724\ \ \ \textcolor{comment}{//\ dispatching\ to\ the\ appropriate\ templated\ function\ when\ the\ argument\ matches}}
\DoxyCodeLine{00725\ \ \ \textcolor{comment}{//\ (with\ a\ fallback\ to\ the\ dynamic\ version).\ Cf\ this\ example:}}
\DoxyCodeLine{00726\ \ \ \textcolor{comment}{//\ https://gist.github.com/disconnect3d/13c2d035bb31b244df14}}
\DoxyCodeLine{00727\ \ \ \textcolor{keywordflow}{switch}(kcount)}
\DoxyCodeLine{00728\ \ \ \{}
\DoxyCodeLine{00729\ \ \ \ \ \textcolor{keywordflow}{case}\ 0:\ assert(\textcolor{keyword}{false}\ \&\&\ \textcolor{stringliteral}{"{}Handled\ above."{}});\ \textcolor{keywordflow}{return}\ Eigen::Matrix<Scalar,n,1>();}
\DoxyCodeLine{00730\ \ \ \ \ \textcolor{comment}{//\ \%\ Matlibberish\ for\ generating\ these\ case\ statements:}}
\DoxyCodeLine{00731\ \ \ \ \ \textcolor{comment}{//\ maxi=16;for\ i=1:maxi;fprintf('\ \ \ \ case\ \%d:\(\backslash\)n\ \ \ \ \{\(\backslash\)n\ \ \ \ \ const\ bool\ D\ =\ (n-\/\%d<=0)||(\%d>=n)||(n>\%d);\(\backslash\)n\ \ \ \ \ return\ min\_quad\_with\_fixed<Scalar,D?Eigen::Dynamic:n,D?Eigen::Dynamic:\%d,Hpd>(H,f,k,bc);\(\backslash\)n\ \ \ \ \}\(\backslash\)n',[i\ i\ i\ maxi\ i]);end}}
\DoxyCodeLine{00732\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{00733\ \ \ \ \ \{}
\DoxyCodeLine{00734\ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ D\ =\ (n-\/1<=0)||(1>=n)||(n>16);}
\DoxyCodeLine{00735\ \ \ \ \ \ \textcolor{keywordflow}{return}\ min\_quad\_with\_fixed<Scalar,D?Eigen::Dynamic:n,D?Eigen::Dynamic:1,Hpd>(H,f,k,bc);}
\DoxyCodeLine{00736\ \ \ \ \ \}}
\DoxyCodeLine{00737\ \ \ \ \ \textcolor{keywordflow}{case}\ 2:}
\DoxyCodeLine{00738\ \ \ \ \ \{}
\DoxyCodeLine{00739\ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ D\ =\ (n-\/2<=0)||(2>=n)||(n>16);}
\DoxyCodeLine{00740\ \ \ \ \ \ \textcolor{keywordflow}{return}\ min\_quad\_with\_fixed<Scalar,D?Eigen::Dynamic:n,D?Eigen::Dynamic:2,Hpd>(H,f,k,bc);}
\DoxyCodeLine{00741\ \ \ \ \ \}}
\DoxyCodeLine{00742\ \ \ \ \ \textcolor{keywordflow}{case}\ 3:}
\DoxyCodeLine{00743\ \ \ \ \ \{}
\DoxyCodeLine{00744\ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ D\ =\ (n-\/3<=0)||(3>=n)||(n>16);}
\DoxyCodeLine{00745\ \ \ \ \ \ \textcolor{keywordflow}{return}\ min\_quad\_with\_fixed<Scalar,D?Eigen::Dynamic:n,D?Eigen::Dynamic:3,Hpd>(H,f,k,bc);}
\DoxyCodeLine{00746\ \ \ \ \ \}}
\DoxyCodeLine{00747\ \ \ \ \ \textcolor{keywordflow}{case}\ 4:}
\DoxyCodeLine{00748\ \ \ \ \ \{}
\DoxyCodeLine{00749\ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ D\ =\ (n-\/4<=0)||(4>=n)||(n>16);}
\DoxyCodeLine{00750\ \ \ \ \ \ \textcolor{keywordflow}{return}\ min\_quad\_with\_fixed<Scalar,D?Eigen::Dynamic:n,D?Eigen::Dynamic:4,Hpd>(H,f,k,bc);}
\DoxyCodeLine{00751\ \ \ \ \ \}}
\DoxyCodeLine{00752\ \ \ \ \ \textcolor{keywordflow}{case}\ 5:}
\DoxyCodeLine{00753\ \ \ \ \ \{}
\DoxyCodeLine{00754\ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ D\ =\ (n-\/5<=0)||(5>=n)||(n>16);}
\DoxyCodeLine{00755\ \ \ \ \ \ \textcolor{keywordflow}{return}\ min\_quad\_with\_fixed<Scalar,D?Eigen::Dynamic:n,D?Eigen::Dynamic:5,Hpd>(H,f,k,bc);}
\DoxyCodeLine{00756\ \ \ \ \ \}}
\DoxyCodeLine{00757\ \ \ \ \ \textcolor{keywordflow}{case}\ 6:}
\DoxyCodeLine{00758\ \ \ \ \ \{}
\DoxyCodeLine{00759\ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ D\ =\ (n-\/6<=0)||(6>=n)||(n>16);}
\DoxyCodeLine{00760\ \ \ \ \ \ \textcolor{keywordflow}{return}\ min\_quad\_with\_fixed<Scalar,D?Eigen::Dynamic:n,D?Eigen::Dynamic:6,Hpd>(H,f,k,bc);}
\DoxyCodeLine{00761\ \ \ \ \ \}}
\DoxyCodeLine{00762\ \ \ \ \ \textcolor{keywordflow}{case}\ 7:}
\DoxyCodeLine{00763\ \ \ \ \ \{}
\DoxyCodeLine{00764\ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ D\ =\ (n-\/7<=0)||(7>=n)||(n>16);}
\DoxyCodeLine{00765\ \ \ \ \ \ \textcolor{keywordflow}{return}\ min\_quad\_with\_fixed<Scalar,D?Eigen::Dynamic:n,D?Eigen::Dynamic:7,Hpd>(H,f,k,bc);}
\DoxyCodeLine{00766\ \ \ \ \ \}}
\DoxyCodeLine{00767\ \ \ \ \ \textcolor{keywordflow}{case}\ 8:}
\DoxyCodeLine{00768\ \ \ \ \ \{}
\DoxyCodeLine{00769\ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ D\ =\ (n-\/8<=0)||(8>=n)||(n>16);}
\DoxyCodeLine{00770\ \ \ \ \ \ \textcolor{keywordflow}{return}\ min\_quad\_with\_fixed<Scalar,D?Eigen::Dynamic:n,D?Eigen::Dynamic:8,Hpd>(H,f,k,bc);}
\DoxyCodeLine{00771\ \ \ \ \ \}}
\DoxyCodeLine{00772\ \ \ \ \ \textcolor{keywordflow}{case}\ 9:}
\DoxyCodeLine{00773\ \ \ \ \ \{}
\DoxyCodeLine{00774\ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ D\ =\ (n-\/9<=0)||(9>=n)||(n>16);}
\DoxyCodeLine{00775\ \ \ \ \ \ \textcolor{keywordflow}{return}\ min\_quad\_with\_fixed<Scalar,D?Eigen::Dynamic:n,D?Eigen::Dynamic:9,Hpd>(H,f,k,bc);}
\DoxyCodeLine{00776\ \ \ \ \ \}}
\DoxyCodeLine{00777\ \ \ \ \ \textcolor{keywordflow}{case}\ 10:}
\DoxyCodeLine{00778\ \ \ \ \ \{}
\DoxyCodeLine{00779\ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ D\ =\ (n-\/10<=0)||(10>=n)||(n>16);}
\DoxyCodeLine{00780\ \ \ \ \ \ \textcolor{keywordflow}{return}\ min\_quad\_with\_fixed<Scalar,D?Eigen::Dynamic:n,D?Eigen::Dynamic:10,Hpd>(H,f,k,bc);}
\DoxyCodeLine{00781\ \ \ \ \ \}}
\DoxyCodeLine{00782\ \ \ \ \ \textcolor{keywordflow}{case}\ 11:}
\DoxyCodeLine{00783\ \ \ \ \ \{}
\DoxyCodeLine{00784\ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ D\ =\ (n-\/11<=0)||(11>=n)||(n>16);}
\DoxyCodeLine{00785\ \ \ \ \ \ \textcolor{keywordflow}{return}\ min\_quad\_with\_fixed<Scalar,D?Eigen::Dynamic:n,D?Eigen::Dynamic:11,Hpd>(H,f,k,bc);}
\DoxyCodeLine{00786\ \ \ \ \ \}}
\DoxyCodeLine{00787\ \ \ \ \ \textcolor{keywordflow}{case}\ 12:}
\DoxyCodeLine{00788\ \ \ \ \ \{}
\DoxyCodeLine{00789\ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ D\ =\ (n-\/12<=0)||(12>=n)||(n>16);}
\DoxyCodeLine{00790\ \ \ \ \ \ \textcolor{keywordflow}{return}\ min\_quad\_with\_fixed<Scalar,D?Eigen::Dynamic:n,D?Eigen::Dynamic:12,Hpd>(H,f,k,bc);}
\DoxyCodeLine{00791\ \ \ \ \ \}}
\DoxyCodeLine{00792\ \ \ \ \ \textcolor{keywordflow}{case}\ 13:}
\DoxyCodeLine{00793\ \ \ \ \ \{}
\DoxyCodeLine{00794\ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ D\ =\ (n-\/13<=0)||(13>=n)||(n>16);}
\DoxyCodeLine{00795\ \ \ \ \ \ \textcolor{keywordflow}{return}\ min\_quad\_with\_fixed<Scalar,D?Eigen::Dynamic:n,D?Eigen::Dynamic:13,Hpd>(H,f,k,bc);}
\DoxyCodeLine{00796\ \ \ \ \ \}}
\DoxyCodeLine{00797\ \ \ \ \ \textcolor{keywordflow}{case}\ 14:}
\DoxyCodeLine{00798\ \ \ \ \ \{}
\DoxyCodeLine{00799\ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ D\ =\ (n-\/14<=0)||(14>=n)||(n>16);}
\DoxyCodeLine{00800\ \ \ \ \ \ \textcolor{keywordflow}{return}\ min\_quad\_with\_fixed<Scalar,D?Eigen::Dynamic:n,D?Eigen::Dynamic:14,Hpd>(H,f,k,bc);}
\DoxyCodeLine{00801\ \ \ \ \ \}}
\DoxyCodeLine{00802\ \ \ \ \ \textcolor{keywordflow}{case}\ 15:}
\DoxyCodeLine{00803\ \ \ \ \ \{}
\DoxyCodeLine{00804\ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ D\ =\ (n-\/15<=0)||(15>=n)||(n>16);}
\DoxyCodeLine{00805\ \ \ \ \ \ \textcolor{keywordflow}{return}\ min\_quad\_with\_fixed<Scalar,D?Eigen::Dynamic:n,D?Eigen::Dynamic:15,Hpd>(H,f,k,bc);}
\DoxyCodeLine{00806\ \ \ \ \ \}}
\DoxyCodeLine{00807\ \ \ \ \ \textcolor{keywordflow}{case}\ 16:}
\DoxyCodeLine{00808\ \ \ \ \ \{}
\DoxyCodeLine{00809\ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ D\ =\ (n-\/16<=0)||(16>=n)||(n>16);}
\DoxyCodeLine{00810\ \ \ \ \ \ \textcolor{keywordflow}{return}\ min\_quad\_with\_fixed<Scalar,D?Eigen::Dynamic:n,D?Eigen::Dynamic:16,Hpd>(H,f,k,bc);}
\DoxyCodeLine{00811\ \ \ \ \ \}}
\DoxyCodeLine{00812\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00813\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ min\_quad\_with\_fixed<Scalar,Eigen::Dynamic,Eigen::Dynamic,Hpd>(H,f,k,bc);}
\DoxyCodeLine{00814\ \ \ \}}
\DoxyCodeLine{00815\ \}}
\DoxyCodeLine{00816\ }
\DoxyCodeLine{00817\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Scalar,\ \textcolor{keywordtype}{int}\ n,\ \textcolor{keywordtype}{int}\ kcount,\ \textcolor{keywordtype}{bool}\ Hpd>}
\DoxyCodeLine{00818\ \mbox{\hyperlink{igl__inline_8h_a838241279013352686271b4c4ce1f708}{IGL\_INLINE}}\ Eigen::Matrix<Scalar,n,1>\ \mbox{\hyperlink{namespaceigl_abcdcf5c62d46412f4b5de5889e51c0d4}{igl::min\_quad\_with\_fixed}}(}
\DoxyCodeLine{00819\ \ \ \textcolor{keyword}{const}\ Eigen::Matrix<Scalar,n,n>\ \&\ H,}
\DoxyCodeLine{00820\ \ \ \textcolor{keyword}{const}\ Eigen::Matrix<Scalar,n,1>\ \&\ f,}
\DoxyCodeLine{00821\ \ \ \textcolor{keyword}{const}\ Eigen::Array<bool,n,1>\ \&\ k,}
\DoxyCodeLine{00822\ \ \ \textcolor{keyword}{const}\ Eigen::Matrix<Scalar,n,1>\ \&\ bc)}
\DoxyCodeLine{00823\ \{}
\DoxyCodeLine{00824\ \ \ \textcolor{comment}{//\ 0\ and\ n\ should\ be\ handle\ outside\ this\ function}}
\DoxyCodeLine{00825\ \ \ \textcolor{keyword}{static\_assert}(kcount==Eigen::Dynamic\ ||\ kcount>0\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ,\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00826\ \ \ \textcolor{keyword}{static\_assert}(kcount==Eigen::Dynamic\ ||\ kcount<n\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ,\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00827\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ ucount\ =\ n==Eigen::Dynamic\ ?\ Eigen::Dynamic\ :\ n-\/kcount;}
\DoxyCodeLine{00828\ \ \ \textcolor{keyword}{static\_assert}(kcount==Eigen::Dynamic\ ||\ ucount+kcount\ ==\ n\ \ \ \ \ \ \ \ ,\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00829\ \ \ \textcolor{keyword}{static\_assert}((n==Eigen::Dynamic)\ ==\ (ucount==Eigen::Dynamic),\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00830\ \ \ \textcolor{keyword}{static\_assert}((kcount==Eigen::Dynamic)\ ==\ (ucount==Eigen::Dynamic),\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00831\ \ \ assert((n==Eigen::Dynamic)\ ||\ n\ ==\ H.rows());}
\DoxyCodeLine{00832\ \ \ assert((kcount==Eigen::Dynamic)\ ||\ kcount\ ==\ k.count());}
\DoxyCodeLine{00833\ \ \ \textcolor{keyword}{typedef}\ Eigen::Matrix<Scalar,ucount,ucount>\ MatrixSuu;}
\DoxyCodeLine{00834\ \ \ \textcolor{keyword}{typedef}\ Eigen::Matrix<Scalar,ucount,kcount>\ MatrixSuk;}
\DoxyCodeLine{00835\ \ \ \textcolor{keyword}{typedef}\ Eigen::Matrix<Scalar,n,1>\ \ \ \ \ \ VectorSn;}
\DoxyCodeLine{00836\ \ \ \textcolor{keyword}{typedef}\ Eigen::Matrix<Scalar,ucount,1>\ VectorSu;}
\DoxyCodeLine{00837\ \ \ \textcolor{keyword}{typedef}\ Eigen::Matrix<Scalar,kcount,1>\ VectorSk;}
\DoxyCodeLine{00838\ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ dyn\_n\ =\ n==Eigen::Dynamic\ ?\ H.rows()\ :\ n;}
\DoxyCodeLine{00839\ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ dyn\_kcount\ =\ kcount==Eigen::Dynamic\ ?\ k.count()\ :\ kcount;}
\DoxyCodeLine{00840\ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ dyn\_ucount\ =\ ucount==Eigen::Dynamic\ ?\ dyn\_n-\/\ dyn\_kcount\ :\ ucount;}
\DoxyCodeLine{00841\ \ \ \textcolor{comment}{//\ For\ ucount==2\ or\ kcount==2\ this\ calls\ the\ coefficient\ initiliazer\ rather}}
\DoxyCodeLine{00842\ \ \ \textcolor{comment}{//\ than\ the\ size\ initilizer,\ but\ I\ guess\ that's\ ok.}}
\DoxyCodeLine{00843\ \ \ MatrixSuu\ Huu(dyn\_ucount,dyn\_ucount);}
\DoxyCodeLine{00844\ \ \ MatrixSuk\ Huk(dyn\_ucount,dyn\_kcount);}
\DoxyCodeLine{00845\ \ \ VectorSu\ mrhs(dyn\_ucount);}
\DoxyCodeLine{00846\ \ \ VectorSk\ \ bck(dyn\_kcount);}
\DoxyCodeLine{00847\ \ \ \{}
\DoxyCodeLine{00848\ \ \ \ \ \textcolor{keywordtype}{int}\ ui\ =\ 0;}
\DoxyCodeLine{00849\ \ \ \ \ \textcolor{keywordtype}{int}\ ki\ =\ 0;}
\DoxyCodeLine{00850\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;i<dyn\_n;i++)}
\DoxyCodeLine{00851\ \ \ \ \ \{}
\DoxyCodeLine{00852\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(k(i))}
\DoxyCodeLine{00853\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00854\ \ \ \ \ \ \ \ \ bck(ki)\ =\ bc(i);}
\DoxyCodeLine{00855\ \ \ \ \ \ \ \ \ ki++;}
\DoxyCodeLine{00856\ \ \ \ \ \ \ \}\textcolor{keywordflow}{else}}
\DoxyCodeLine{00857\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00858\ \ \ \ \ \ \ \ \ mrhs(ui)\ =\ f(i);}
\DoxyCodeLine{00859\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ uj\ =\ 0;}
\DoxyCodeLine{00860\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ kj\ =\ 0;}
\DoxyCodeLine{00861\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j\ =\ 0;j<dyn\_n;j++)}
\DoxyCodeLine{00862\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00863\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(k(j))}
\DoxyCodeLine{00864\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00865\ \ \ \ \ \ \ \ \ \ \ \ \ Huk(ui,kj)\ =\ H(i,j);}
\DoxyCodeLine{00866\ \ \ \ \ \ \ \ \ \ \ \ \ kj++;}
\DoxyCodeLine{00867\ \ \ \ \ \ \ \ \ \ \ \}\textcolor{keywordflow}{else}}
\DoxyCodeLine{00868\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00869\ \ \ \ \ \ \ \ \ \ \ \ \ Huu(ui,uj)\ =\ H(i,j);}
\DoxyCodeLine{00870\ \ \ \ \ \ \ \ \ \ \ \ \ uj++;}
\DoxyCodeLine{00871\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00872\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00873\ \ \ \ \ \ \ \ \ ui++;}
\DoxyCodeLine{00874\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00875\ \ \ \ \ \}}
\DoxyCodeLine{00876\ \ \ \}}
\DoxyCodeLine{00877\ \ \ mrhs\ +=\ Huk\ *\ bck;}
\DoxyCodeLine{00878\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}}
\DoxyCodeLine{00879\ \ \ \ \ std::conditional<Hpd,}
\DoxyCodeLine{00880\ \ \ \ \ \ \ Eigen::LLT<MatrixSuu>,}
\DoxyCodeLine{00881\ \ \ \ \ \ \ \textcolor{comment}{//\ LDLT\ should\ be\ faster\ for\ indefinite\ problems\ but\ already\ found\ some}}
\DoxyCodeLine{00882\ \ \ \ \ \ \ \textcolor{comment}{//\ cases\ where\ it\ was\ too\ inaccurate\ when\ called\ via\ quadprog\_primal.}}
\DoxyCodeLine{00883\ \ \ \ \ \ \ \textcolor{comment}{//\ Ideally\ this\ function\ takes\ LLT,LDLT,\ or}}
\DoxyCodeLine{00884\ \ \ \ \ \ \ \textcolor{comment}{//\ CompleteOrthogonalDecomposition\ as\ a\ template\ parameter.\ \ "{}template}}
\DoxyCodeLine{00885\ \ \ \ \ \ \ \textcolor{comment}{//\ template"{}\ parameters\ did\ work\ because\ LLT,LDLT\ have\ different\ number\ of}}
\DoxyCodeLine{00886\ \ \ \ \ \ \ \textcolor{comment}{//\ template\ parameters\ from\ CompleteOrthogonalDecomposition.\ \ Perhaps}}
\DoxyCodeLine{00887\ \ \ \ \ \ \ \textcolor{comment}{//\ there's\ a\ way\ to\ take\ advantage\ of\ LLT\ and\ LDLT's\ default\ template}}
\DoxyCodeLine{00888\ \ \ \ \ \ \ \textcolor{comment}{//\ parameters\ (I\ couldn't\ figure\ out\ how).}}
\DoxyCodeLine{00889\ \ \ \ \ \ \ Eigen::CompleteOrthogonalDecomposition<MatrixSuu>>::type}
\DoxyCodeLine{00890\ \ \ \ \ Solver;}
\DoxyCodeLine{00891\ \ \ VectorSu\ xu\ =\ Solver(Huu).solve(-\/mrhs);}
\DoxyCodeLine{00892\ \ \ VectorSn\ x(dyn\_n);}
\DoxyCodeLine{00893\ \ \ \{}
\DoxyCodeLine{00894\ \ \ \ \ \textcolor{keywordtype}{int}\ ui\ =\ 0;}
\DoxyCodeLine{00895\ \ \ \ \ \textcolor{keywordtype}{int}\ ki\ =\ 0;}
\DoxyCodeLine{00896\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;i<dyn\_n;i++)}
\DoxyCodeLine{00897\ \ \ \ \ \{}
\DoxyCodeLine{00898\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(k(i))}
\DoxyCodeLine{00899\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00900\ \ \ \ \ \ \ \ \ x(i)\ =\ bck(ki);}
\DoxyCodeLine{00901\ \ \ \ \ \ \ \ \ ki++;}
\DoxyCodeLine{00902\ \ \ \ \ \ \ \}\textcolor{keywordflow}{else}}
\DoxyCodeLine{00903\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00904\ \ \ \ \ \ \ \ \ x(i)\ =\ xu(ui);}
\DoxyCodeLine{00905\ \ \ \ \ \ \ \ \ ui++;}
\DoxyCodeLine{00906\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00907\ \ \ \ \ \}}
\DoxyCodeLine{00908\ \ \ \}}
\DoxyCodeLine{00909\ \ \ \textcolor{keywordflow}{return}\ x;}
\DoxyCodeLine{00910\ \}}

\end{DoxyCode}

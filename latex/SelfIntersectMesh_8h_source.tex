\doxysection{Self\+Intersect\+Mesh.\+h}
\hypertarget{SelfIntersectMesh_8h_source}{}\label{SelfIntersectMesh_8h_source}\index{include/igl/copyleft/cgal/SelfIntersectMesh.h@{include/igl/copyleft/cgal/SelfIntersectMesh.h}}
\mbox{\hyperlink{SelfIntersectMesh_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ This\ file\ is\ part\ of\ libigl,\ a\ simple\ c++\ geometry\ processing\ library.}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ }}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ Copyright\ (C)\ 2014\ Alec\ Jacobson\ <alecjacobson@gmail.com>\ }}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ }}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ This\ Source\ Code\ Form\ is\ subject\ to\ the\ terms\ of\ the\ Mozilla\ Public\ License\ }}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ v.\ 2.0.\ If\ a\ copy\ of\ the\ MPL\ was\ not\ distributed\ with\ this\ file,\ You\ can\ }}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ obtain\ one\ at\ http://mozilla.org/MPL/2.0/.}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#ifndef\ IGL\_COPYLEFT\_CGAL\_SELFINTERSECTMESH\_H}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#define\ IGL\_COPYLEFT\_CGAL\_SELFINTERSECTMESH\_H}}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ "{}CGAL\_includes.hpp"{}}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{RemeshSelfIntersectionsParam_8h}{RemeshSelfIntersectionsParam.h}}"{}}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{unique_8h}{../../unique.h}}"{}}}
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{default__num__threads_8h}{../../default\_num\_threads.h}}"{}}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ <Eigen/Dense>}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ <list>}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ <map>}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ <thread>}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ <mutex>}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ <cstdio>}}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \textcolor{comment}{//\#define\ IGL\_SELFINTERSECTMESH\_TIMING}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#ifndef\ IGL\_FIRST\_HIT\_EXCEPTION}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#define\ IGL\_FIRST\_HIT\_EXCEPTION\ 10}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \textcolor{comment}{//\ The\ easiest\ way\ to\ keep\ track\ of\ everything\ is\ to\ use\ a\ class}}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceigl}{igl}}}
\DoxyCodeLine{00032\ \{}
\DoxyCodeLine{00033\ \ \ \textcolor{keyword}{namespace\ }copyleft}
\DoxyCodeLine{00034\ \ \ \{}
\DoxyCodeLine{00035\ \ \ \ \ \textcolor{keyword}{namespace\ }cgal}
\DoxyCodeLine{00036\ \ \ \ \ \{}
\DoxyCodeLine{00043\ \ \ \ \ \ \ \textcolor{keyword}{template}\ <}
\DoxyCodeLine{00044\ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ Kernel,}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ DerivedV,}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ DerivedF,}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ DerivedVV,}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ DerivedFF,}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ DerivedIF,}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ DerivedJ,}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ DerivedIM>}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh}{SelfIntersectMesh}}}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \textcolor{keyword}{typedef}}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh}{SelfIntersectMesh}}<}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \ \ Kernel,}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \ \ DerivedV,}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \ \ DerivedF,}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \ \ DerivedVV,}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \ \ DerivedFF,}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \ \ DerivedIF,}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \ \ DerivedJ,}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \ \ DerivedIM>\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh}{Self}};}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ 3D\ Primitives}}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ CGAL::Point\_3<Kernel>\ \ \ \ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_aca08ae5f7bd9e8af5294cd2466a2cadc}{Point\_3}};}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ CGAL::Segment\_3<Kernel>\ \ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a1152aad98bdadc62f3feeaecf591f88c}{Segment\_3}};}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ CGAL::Triangle\_3<Kernel>\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a08b88627a638dec1767ad4964dae7fe7}{Triangle\_3}};}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ CGAL::Plane\_3<Kernel>\ \ \ \ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a92476bfc974726de0e270389a8aa3fd8}{Plane\_3}};}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ CGAL::Tetrahedron\_3<Kernel>\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a12f97e8f7dc8e610ba28b91a41493e9c}{Tetrahedron\_3}};}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ 2D\ Primitives}}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ CGAL::Point\_2<Kernel>\ \ \ \ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a1e43e61638ea86fb97689db5459ff36c}{Point\_2}};}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ CGAL::Segment\_2<Kernel>\ \ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_ab5b32c5b4d976f5cc1f5fa4b574b7fea}{Segment\_2}};}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ CGAL::Triangle\_2<Kernel>\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_afe79a42e91a71b4ba98a4901b574db58}{Triangle\_2}};}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ 2D\ Constrained\ Delaunay\ Triangulation\ types}}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ CGAL::Exact\_intersections\_tag\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_afcf79dbfec1a9a9a01c17dc67514ce61}{Itag}};}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Axis-\/align\ boxes\ for\ all-\/pairs\ self-\/intersection\ detection}}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ std::vector<Triangle\_3>\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_ad833c0bbf165d35d5ef416f144d7ae52}{Triangles}};}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ Triangles::iterator\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_ae54c0c45d541cefe848b5a698e636c28}{TrianglesIterator}};}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ Triangles::const\_iterator\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_aff339eeedc761f657b0ac97ffdfc1824}{TrianglesConstIterator}};}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typedef}}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ \ \ \ \ CGAL::Box\_intersection\_d::Box\_with\_handle\_d<double,3,TrianglesIterator>}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a3ecb2a1e8a582bfc5a0be109bc6a0afd}{Box}};}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Input\ mesh}}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Eigen::MatrixBase<DerivedV>\ \&\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a93ef8bc8113137c9421d8599c420c6b7}{V}};}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Eigen::MatrixBase<DerivedF>\ \&\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a3ffd426cf9b46ee61f0d189c52856313}{F}};}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Number\ of\ self-\/intersecting\ triangle\ pairs}}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ DerivedF::Index\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a3be180f5be3130421d1df3738caa3922}{Index}};}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a3be180f5be3130421d1df3738caa3922}{Index}}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a1e6d46c014d357bc3919258b48e5c3ae}{count}};}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ std::vector<std::pair<Index,\ CGAL::Object>>\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_ac56b1000b340eb1fbc5be68ce0290773}{ObjectList}};}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Using\ a\ vector\ here\ makes\ this\ **not**\ output\ sensitive}}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_ad833c0bbf165d35d5ef416f144d7ae52}{Triangles}}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a5c0c06babba1e8ed96fec7d3b2a35204}{T}};}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ std::vector<Index>\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_ad79e3e94166c02959a885f1765a391aa}{IndexList}};}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_ad79e3e94166c02959a885f1765a391aa}{IndexList}}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a13efd5482d0e7e1db8cd0470f326dea3}{lIF}};}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \#F-\/long\ list\ of\ faces\ with\ intersections\ mapping\ to\ the\ order\ in}}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ which\ they\ were\ first\ found}}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \ \ std::map<Index,ObjectList>\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_af9bc58c53ef0b45d3b5ee56fe65e8554}{offending}};}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Make\ a\ short\ name\ for\ the\ edge\ map's\ key}}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ std::pair<Index,Index>\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a228a539b03cd925f72ab37028914c18a}{EMK}};}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Make\ a\ short\ name\ for\ the\ type\ stored\ at\ each\ edge,\ the\ edge\ map's}}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ value}}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ std::vector<Index>\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_aeef7725804828596abe690dcb4524a4e}{EMV}};}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Make\ a\ short\ name\ for\ the\ edge\ map}}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ std::map<EMK,EMV>\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_aa66c8e9c68c444272a378daee20dc0bc}{EdgeMap}};}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Maps\ edges\ of\ offending\ faces\ to\ all\ incident\ offending\ faces}}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ \ \ std::vector<std::pair<TrianglesIterator,\ TrianglesIterator>\ >}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a2af1c41e04b0470ae61744e419646522}{candidate\_triangle\_pairs}};}
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structigl_1_1copyleft_1_1cgal_1_1RemeshSelfIntersectionsParam}{RemeshSelfIntersectionsParam}}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a4f0bfd48f1b39ab00b7fc5bf4e34733f}{params}};}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{inline}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_abd759e325ecce8c9c7c392d4acea5991}{SelfIntersectMesh}}(}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Eigen::MatrixBase<DerivedV>\ \&\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a93ef8bc8113137c9421d8599c420c6b7}{V}},}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Eigen::MatrixBase<DerivedF>\ \&\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a3ffd426cf9b46ee61f0d189c52856313}{F}},}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structigl_1_1copyleft_1_1cgal_1_1RemeshSelfIntersectionsParam}{RemeshSelfIntersectionsParam}}\ \&\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a4f0bfd48f1b39ab00b7fc5bf4e34733f}{params}},}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Eigen::PlainObjectBase<DerivedVV>\ \&\ VV,}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Eigen::PlainObjectBase<DerivedFF>\ \&\ FF,}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Eigen::PlainObjectBase<DerivedIF>\ \&\ IF,}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Eigen::PlainObjectBase<DerivedJ>\ \&\ J,}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Eigen::PlainObjectBase<DerivedIM>\ \&\ IM);}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ mark\_offensive(\textcolor{keyword}{const}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a3be180f5be3130421d1df3738caa3922}{Index}}\ f);}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ count\_intersection(\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a3be180f5be3130421d1df3738caa3922}{Index}}\ fa,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a3be180f5be3130421d1df3738caa3922}{Index}}\ fb);}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ intersect(}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a08b88627a638dec1767ad4964dae7fe7}{Triangle\_3}}\ \&\ A,}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a08b88627a638dec1767ad4964dae7fe7}{Triangle\_3}}\ \&\ B,}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a3be180f5be3130421d1df3738caa3922}{Index}}\ fa,}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a3be180f5be3130421d1df3738caa3922}{Index}}\ fb);}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ single\_shared\_vertex(}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a08b88627a638dec1767ad4964dae7fe7}{Triangle\_3}}\ \&\ A,}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a08b88627a638dec1767ad4964dae7fe7}{Triangle\_3}}\ \&\ B,}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a3be180f5be3130421d1df3738caa3922}{Index}}\ fa,}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a3be180f5be3130421d1df3738caa3922}{Index}}\ fb,}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a3be180f5be3130421d1df3738caa3922}{Index}}\ va,}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a3be180f5be3130421d1df3738caa3922}{Index}}\ vb);}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ single\_shared\_vertex(}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a08b88627a638dec1767ad4964dae7fe7}{Triangle\_3}}\ \&\ A,}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a08b88627a638dec1767ad4964dae7fe7}{Triangle\_3}}\ \&\ B,}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a3be180f5be3130421d1df3738caa3922}{Index}}\ fa,}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a3be180f5be3130421d1df3738caa3922}{Index}}\ fb,}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a3be180f5be3130421d1df3738caa3922}{Index}}\ va);}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ double\_shared\_vertex(}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a08b88627a638dec1767ad4964dae7fe7}{Triangle\_3}}\ \&\ A,}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a08b88627a638dec1767ad4964dae7fe7}{Triangle\_3}}\ \&\ B,}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a3be180f5be3130421d1df3738caa3922}{Index}}\ fa,}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a3be180f5be3130421d1df3738caa3922}{Index}}\ fb,}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<std::pair<Index,Index>\ >\ shared);}
\DoxyCodeLine{00212\ }
\DoxyCodeLine{00213\ \ \ \ \ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00220\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_ad6b7a9069d13185a3919b36d0e606f8c}{box\_intersect}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a3ecb2a1e8a582bfc5a0be109bc6a0afd}{Box}}\&\ a,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a3ecb2a1e8a582bfc5a0be109bc6a0afd}{Box}}\&\ b);}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a1f15ee5b85962d795332dc26ed293695}{process\_intersecting\_boxes}}();}
\DoxyCodeLine{00223\ \ \ \ \ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00224\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Getters:}}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//const\ IndexList\&\ get\_lIF()\ const\{\ return\ lIF;\}}}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_acda8f3656a13b903a25e7cdb3040764e}{box\_intersect\_static}}(}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh}{SelfIntersectMesh}}\ *\ SIM,}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a3ecb2a1e8a582bfc5a0be109bc6a0afd}{Box}}\ \&a,}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a3ecb2a1e8a582bfc5a0be109bc6a0afd}{Box}}\ \&b);}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ \ \ std::mutex\ m\_offending\_lock;}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \};}
\DoxyCodeLine{00238\ \ \ \ \ \}}
\DoxyCodeLine{00239\ \ \ \}}
\DoxyCodeLine{00240\ \}}
\DoxyCodeLine{00241\ }
\DoxyCodeLine{00242\ \textcolor{comment}{//\ Implementation}}
\DoxyCodeLine{00243\ }
\DoxyCodeLine{00244\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{mesh__to__cgal__triangle__list_8h}{mesh\_to\_cgal\_triangle\_list.h}}"{}}}
\DoxyCodeLine{00245\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{remesh__intersections_8h}{remesh\_intersections.h}}"{}}}
\DoxyCodeLine{00246\ }
\DoxyCodeLine{00247\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{get__seconds_8h}{../../get\_seconds.h}}"{}}}
\DoxyCodeLine{00248\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{C__STR_8h}{../../C\_STR.h}}"{}}}
\DoxyCodeLine{00249\ }
\DoxyCodeLine{00250\ }
\DoxyCodeLine{00251\ \textcolor{preprocessor}{\#include\ <functional>}}
\DoxyCodeLine{00252\ \textcolor{preprocessor}{\#include\ <algorithm>}}
\DoxyCodeLine{00253\ \textcolor{preprocessor}{\#include\ <exception>}}
\DoxyCodeLine{00254\ \textcolor{preprocessor}{\#include\ <cassert>}}
\DoxyCodeLine{00255\ }
\DoxyCodeLine{00256\ \textcolor{comment}{//\ References:}}
\DoxyCodeLine{00257\ \textcolor{comment}{//\ http://minregret.googlecode.com/svn/trunk/skyline/src/extern/CGAL-\/3.3.1/examples/Polyhedron/polyhedron\_self\_intersection.cpp}}
\DoxyCodeLine{00258\ \textcolor{comment}{//\ http://www.cgal.org/Manual/3.9/examples/Boolean\_set\_operations\_2/do\_intersect.cpp}}
\DoxyCodeLine{00259\ }
\DoxyCodeLine{00260\ \textcolor{comment}{//\ Q:\ Should\ we\ be\ using\ CGAL::Polyhedron\_3?}}
\DoxyCodeLine{00261\ \textcolor{comment}{//\ A:\ No!\ Input\ is\ just\ a\ list\ of\ unoriented\ triangles.\ Polyhedron\_3\ requires}}
\DoxyCodeLine{00262\ \textcolor{comment}{//\ a\ 2-\/manifold.}}
\DoxyCodeLine{00263\ \textcolor{comment}{//\ A:\ But!\ It\ seems\ we\ could\ use\ CGAL::Triangulation\_3.\ Though\ it\ won't\ be\ easy}}
\DoxyCodeLine{00264\ \textcolor{comment}{//\ to\ take\ advantage\ of\ functions\ like\ insert\_in\_facet\ because\ we\ want\ to}}
\DoxyCodeLine{00265\ \textcolor{comment}{//\ constrain\ segments.\ Hmmm.\ Actually\ Triangulation\_3\ doesn't\ look\ right...}}
\DoxyCodeLine{00266\ }
\DoxyCodeLine{00267\ \textcolor{comment}{//\ CGAL's\ box\_self\_intersection\_d\ uses\ C-\/style\ function\ callbacks\ without}}
\DoxyCodeLine{00268\ \textcolor{comment}{//\ userdata.\ This\ is\ a\ leapfrog\ method\ for\ calling\ a\ member\ function.\ It\ should}}
\DoxyCodeLine{00269\ \textcolor{comment}{//\ be\ bound\ as\ if\ the\ prototype\ was:}}
\DoxyCodeLine{00270\ \textcolor{comment}{//\ \ \ static\ void\ box\_intersect(const\ Box\ \&a,\ const\ Box\ \&b)}}
\DoxyCodeLine{00271\ \textcolor{comment}{//\ using\ boost:}}
\DoxyCodeLine{00272\ \textcolor{comment}{//\ \ boost::function<void(const\ Box\ \&a,const\ Box\ \&b)>\ cb}}
\DoxyCodeLine{00273\ \textcolor{comment}{//\ \ \ \ =\ boost::bind(\&::box\_intersect,\ this,\ \_1,\_2);}}
\DoxyCodeLine{00274\ \textcolor{comment}{//}}
\DoxyCodeLine{00275\ \textcolor{keyword}{template}\ <}
\DoxyCodeLine{00276\ \ \ \textcolor{keyword}{typename}\ Kernel,}
\DoxyCodeLine{00277\ \ \ \textcolor{keyword}{typename}\ DerivedV,}
\DoxyCodeLine{00278\ \ \ \textcolor{keyword}{typename}\ DerivedF,}
\DoxyCodeLine{00279\ \ \ \textcolor{keyword}{typename}\ DerivedVV,}
\DoxyCodeLine{00280\ \ \ \textcolor{keyword}{typename}\ DerivedFF,}
\DoxyCodeLine{00281\ \ \ \textcolor{keyword}{typename}\ DerivedIF,}
\DoxyCodeLine{00282\ \ \ \textcolor{keyword}{typename}\ DerivedJ,}
\DoxyCodeLine{00283\ \ \ \textcolor{keyword}{typename}\ DerivedIM>}
\DoxyCodeLine{00284\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh}{igl::copyleft::cgal::SelfIntersectMesh}}<}
\DoxyCodeLine{00285\ \ \ Kernel,}
\DoxyCodeLine{00286\ \ \ DerivedV,}
\DoxyCodeLine{00287\ \ \ DerivedF,}
\DoxyCodeLine{00288\ \ \ DerivedVV,}
\DoxyCodeLine{00289\ \ \ DerivedFF,}
\DoxyCodeLine{00290\ \ \ DerivedIF,}
\DoxyCodeLine{00291\ \ \ DerivedJ,}
\DoxyCodeLine{00292\ \ \ DerivedIM>::box\_intersect\_static(}
\DoxyCodeLine{00293\ \ \ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh}{Self}}\ *\ SIM,}
\DoxyCodeLine{00294\ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a3ecb2a1e8a582bfc5a0be109bc6a0afd}{Self::Box}}\ \&a,}
\DoxyCodeLine{00295\ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a3ecb2a1e8a582bfc5a0be109bc6a0afd}{Self::Box}}\ \&b)}
\DoxyCodeLine{00296\ \{}
\DoxyCodeLine{00297\ \ \ SIM-\/>\mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_ad6b7a9069d13185a3919b36d0e606f8c}{box\_intersect}}(a,b);}
\DoxyCodeLine{00298\ \}}
\DoxyCodeLine{00299\ }
\DoxyCodeLine{00300\ \textcolor{keyword}{template}\ <}
\DoxyCodeLine{00301\ \ \ \textcolor{keyword}{typename}\ Kernel,}
\DoxyCodeLine{00302\ \ \ \textcolor{keyword}{typename}\ DerivedV,}
\DoxyCodeLine{00303\ \ \ \textcolor{keyword}{typename}\ DerivedF,}
\DoxyCodeLine{00304\ \ \ \textcolor{keyword}{typename}\ DerivedVV,}
\DoxyCodeLine{00305\ \ \ \textcolor{keyword}{typename}\ DerivedFF,}
\DoxyCodeLine{00306\ \ \ \textcolor{keyword}{typename}\ DerivedIF,}
\DoxyCodeLine{00307\ \ \ \textcolor{keyword}{typename}\ DerivedJ,}
\DoxyCodeLine{00308\ \ \ \textcolor{keyword}{typename}\ DerivedIM>}
\DoxyCodeLine{00309\ \textcolor{keyword}{inline}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh}{igl::copyleft::cgal::SelfIntersectMesh}}<}
\DoxyCodeLine{00310\ \ \ Kernel,}
\DoxyCodeLine{00311\ \ \ DerivedV,}
\DoxyCodeLine{00312\ \ \ DerivedF,}
\DoxyCodeLine{00313\ \ \ DerivedVV,}
\DoxyCodeLine{00314\ \ \ DerivedFF,}
\DoxyCodeLine{00315\ \ \ DerivedIF,}
\DoxyCodeLine{00316\ \ \ DerivedJ,}
\DoxyCodeLine{00317\ \ \ DerivedIM>::SelfIntersectMesh(}
\DoxyCodeLine{00318\ \ \ \textcolor{keyword}{const}\ Eigen::MatrixBase<DerivedV>\ \&\ V,}
\DoxyCodeLine{00319\ \ \ \textcolor{keyword}{const}\ Eigen::MatrixBase<DerivedF>\ \&\ F,}
\DoxyCodeLine{00320\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structigl_1_1copyleft_1_1cgal_1_1RemeshSelfIntersectionsParam}{RemeshSelfIntersectionsParam}}\ \&\ params,}
\DoxyCodeLine{00321\ \ \ Eigen::PlainObjectBase<DerivedVV>\ \&\ VV,}
\DoxyCodeLine{00322\ \ \ Eigen::PlainObjectBase<DerivedFF>\ \&\ FF,}
\DoxyCodeLine{00323\ \ \ Eigen::PlainObjectBase<DerivedIF>\ \&\ IF,}
\DoxyCodeLine{00324\ \ \ Eigen::PlainObjectBase<DerivedJ>\ \&\ J,}
\DoxyCodeLine{00325\ \ \ Eigen::PlainObjectBase<DerivedIM>\ \&\ IM):}
\DoxyCodeLine{00326\ \ \ V(V),}
\DoxyCodeLine{00327\ \ \ F(F),}
\DoxyCodeLine{00328\ \ \ \mbox{\hyperlink{namespaceigl_a83819bb842f4bc4c8af21a98e1db44b3}{count}}(0),}
\DoxyCodeLine{00329\ \ \ T(),}
\DoxyCodeLine{00330\ \ \ lIF(),}
\DoxyCodeLine{00331\ \ \ offending(),}
\DoxyCodeLine{00332\ \ \ params(params)}
\DoxyCodeLine{00333\ \{}
\DoxyCodeLine{00334\ \ \ \textcolor{keyword}{using\ namespace\ }std;}
\DoxyCodeLine{00335\ \ \ \textcolor{keyword}{using\ namespace\ }Eigen;}
\DoxyCodeLine{00336\ }
\DoxyCodeLine{00337\ \textcolor{preprocessor}{\#ifdef\ IGL\_SELFINTERSECTMESH\_TIMING}}
\DoxyCodeLine{00338\ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ \&\ tictoc\ =\ []()\ -\/>\ \textcolor{keywordtype}{double}}
\DoxyCodeLine{00339\ \ \ \{}
\DoxyCodeLine{00340\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{double}\ t\_start\ =\ \mbox{\hyperlink{namespaceigl_a14a7a848b8b1eb296b5c8b80efc05efc}{igl::get\_seconds}}();}
\DoxyCodeLine{00341\ \ \ \ \ \textcolor{keywordtype}{double}\ diff\ =\ \mbox{\hyperlink{namespaceigl_a14a7a848b8b1eb296b5c8b80efc05efc}{igl::get\_seconds}}()-\/t\_start;}
\DoxyCodeLine{00342\ \ \ \ \ t\_start\ +=\ diff;}
\DoxyCodeLine{00343\ \ \ \ \ \textcolor{keywordflow}{return}\ diff;}
\DoxyCodeLine{00344\ \ \ \};}
\DoxyCodeLine{00345\ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ log\_time\ =\ [\&](\textcolor{keyword}{const}\ std::string\&\ label)\ -\/>\ \textcolor{keywordtype}{void}\{}
\DoxyCodeLine{00346\ \ \ \ \ std::printf(\textcolor{stringliteral}{"{}\%50s:\ \%0.5lf\(\backslash\)n"{}},}
\DoxyCodeLine{00347\ \ \ \ \ \ \ \mbox{\hyperlink{C__STR_8h_a0694d2f2211a224ad161925f11cc2c31}{C\_STR}}(\textcolor{stringliteral}{"{}SelfIntersectMesh."{}}\ <<\ label),tictoc());}
\DoxyCodeLine{00348\ \ \ \};}
\DoxyCodeLine{00349\ \ \ tictoc();}
\DoxyCodeLine{00350\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00351\ }
\DoxyCodeLine{00352\ \ \ \textcolor{comment}{//\ Compute\ and\ process\ self\ intersections}}
\DoxyCodeLine{00353\ \ \ \mbox{\hyperlink{namespaceigl_1_1copyleft_1_1cgal_ac9d72d2b7b5a3aa61b67b44df084c7db}{mesh\_to\_cgal\_triangle\_list}}(\mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a93ef8bc8113137c9421d8599c420c6b7}{V}},\mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a3ffd426cf9b46ee61f0d189c52856313}{F}},\mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a5c0c06babba1e8ed96fec7d3b2a35204}{T}});}
\DoxyCodeLine{00354\ \textcolor{preprocessor}{\#ifdef\ IGL\_SELFINTERSECTMESH\_TIMING}}
\DoxyCodeLine{00355\ \ \ log\_time(\textcolor{stringliteral}{"{}convert\_to\_triangle\_list"{}});}
\DoxyCodeLine{00356\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00357\ \ \ \textcolor{comment}{//\ http://www.cgal.org/Manual/latest/doc\_html/cgal\_manual/Box\_intersection\_d/Chapter\_main.html\#Section\_63.5}}
\DoxyCodeLine{00358\ \ \ \textcolor{comment}{//\ Create\ the\ corresponding\ vector\ of\ bounding\ boxes}}
\DoxyCodeLine{00359\ \ \ std::vector<Box>\ boxes;}
\DoxyCodeLine{00360\ \ \ boxes.reserve(\mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a5c0c06babba1e8ed96fec7d3b2a35204}{T}}.size());}
\DoxyCodeLine{00361\ \ \ \textcolor{keywordflow}{for}\ (}
\DoxyCodeLine{00362\ \ \ \ \ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_ae54c0c45d541cefe848b5a698e636c28}{TrianglesIterator}}\ tit\ =\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a5c0c06babba1e8ed96fec7d3b2a35204}{T}}.begin();}
\DoxyCodeLine{00363\ \ \ \ \ tit\ !=\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a5c0c06babba1e8ed96fec7d3b2a35204}{T}}.end();}
\DoxyCodeLine{00364\ \ \ \ \ ++tit)}
\DoxyCodeLine{00365\ \ \ \{}
\DoxyCodeLine{00366\ \ \ \ \ \textcolor{keywordflow}{if}\ (!tit-\/>is\_degenerate())}
\DoxyCodeLine{00367\ \ \ \ \ \{}
\DoxyCodeLine{00368\ \ \ \ \ \ \ boxes.push\_back(\mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a3ecb2a1e8a582bfc5a0be109bc6a0afd}{Box}}(tit-\/>bbox(),\ tit));}
\DoxyCodeLine{00369\ \ \ \ \ \}}
\DoxyCodeLine{00370\ \ \ \}}
\DoxyCodeLine{00371\ \ \ \textcolor{comment}{//\ Leapfrog\ callback}}
\DoxyCodeLine{00372\ \ \ std::function<void(\textcolor{keyword}{const}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a3ecb2a1e8a582bfc5a0be109bc6a0afd}{Box}}\ \&a,\textcolor{keyword}{const}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a3ecb2a1e8a582bfc5a0be109bc6a0afd}{Box}}\ \&b)>\ cb\ =}
\DoxyCodeLine{00373\ \ \ \ \ std::bind(\&\mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_acda8f3656a13b903a25e7cdb3040764e}{box\_intersect\_static}},\ \textcolor{keyword}{this},}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \textcolor{comment}{//\ Explicitly\ use\ std\ namespace\ to\ avoid\ confusion\ with\ boost\ (who\ puts}}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \textcolor{comment}{//\ \_1\ etc.\ in\ global\ namespace)}}
\DoxyCodeLine{00376\ \ \ \ \ \ \ std::placeholders::\_1,}
\DoxyCodeLine{00377\ \ \ \ \ \ \ std::placeholders::\_2);}
\DoxyCodeLine{00378\ \textcolor{preprocessor}{\#ifdef\ IGL\_SELFINTERSECTMESH\_TIMING}}
\DoxyCodeLine{00379\ \ \ log\_time(\textcolor{stringliteral}{"{}box\_and\_bind"{}});}
\DoxyCodeLine{00380\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00381\ \ \ \textcolor{comment}{//\ Run\ the\ self\ intersection\ algorithm\ with\ given\ cutoff\ size}}
\DoxyCodeLine{00382\ \ \ CGAL::box\_self\_intersection\_d(boxes.begin(),\ boxes.end(),cb,std::ptrdiff\_t(\mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a4f0bfd48f1b39ab00b7fc5bf4e34733f}{params}}.\mbox{\hyperlink{structigl_1_1copyleft_1_1cgal_1_1RemeshSelfIntersectionsParam_ae7ba2931a13ae300b0aab512eb87d6c6}{cutoff}}));}
\DoxyCodeLine{00383\ \textcolor{preprocessor}{\#ifdef\ IGL\_SELFINTERSECTMESH\_TIMING}}
\DoxyCodeLine{00384\ \ \ log\_time(\textcolor{stringliteral}{"{}box\_intersection\_d"{}});}
\DoxyCodeLine{00385\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00386\ \ \ \textcolor{keywordflow}{try}\{}
\DoxyCodeLine{00387\ \ \ \ \ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a1f15ee5b85962d795332dc26ed293695}{process\_intersecting\_boxes}}();}
\DoxyCodeLine{00388\ \ \ \}\textcolor{keywordflow}{catch}(\textcolor{keywordtype}{int}\ e)}
\DoxyCodeLine{00389\ \ \ \{}
\DoxyCodeLine{00390\ \ \ \ \ \textcolor{comment}{//\ Rethrow\ if\ not\ IGL\_FIRST\_HIT\_EXCEPTION}}
\DoxyCodeLine{00391\ \ \ \ \ \textcolor{keywordflow}{if}(e\ !=\ \mbox{\hyperlink{SelfIntersectMesh_8h_a80fe8a5758f21b2e4e9eee2ed44a2f2e}{IGL\_FIRST\_HIT\_EXCEPTION}})}
\DoxyCodeLine{00392\ \ \ \ \ \{}
\DoxyCodeLine{00393\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ e;}
\DoxyCodeLine{00394\ \ \ \ \ \}}
\DoxyCodeLine{00395\ \ \ \ \ \textcolor{comment}{//\ Otherwise\ just\ fall\ through}}
\DoxyCodeLine{00396\ \ \ \}}
\DoxyCodeLine{00397\ \textcolor{preprocessor}{\#ifdef\ IGL\_SELFINTERSECTMESH\_TIMING}}
\DoxyCodeLine{00398\ \ \ log\_time(\textcolor{stringliteral}{"{}resolve\_intersection"{}});}
\DoxyCodeLine{00399\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00400\ }
\DoxyCodeLine{00401\ \ \ \textcolor{comment}{//\ Convert\ lIF\ to\ Eigen\ matrix}}
\DoxyCodeLine{00402\ \ \ assert(\mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a13efd5482d0e7e1db8cd0470f326dea3}{lIF}}.size()\%2\ ==\ 0);}
\DoxyCodeLine{00403\ \ \ IF.resize(\mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a13efd5482d0e7e1db8cd0470f326dea3}{lIF}}.size()/2,2);}
\DoxyCodeLine{00404\ \ \ \{}
\DoxyCodeLine{00405\ \ \ \ \ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a3be180f5be3130421d1df3738caa3922}{Index}}\ i=0;}
\DoxyCodeLine{00406\ \ \ \ \ \textcolor{keywordflow}{for}(}
\DoxyCodeLine{00407\ \ \ \ \ \ \ \textcolor{keyword}{typename}\ IndexList::const\_iterator\ ifit\ =\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a13efd5482d0e7e1db8cd0470f326dea3}{lIF}}.begin();}
\DoxyCodeLine{00408\ \ \ \ \ \ \ ifit!=\mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a13efd5482d0e7e1db8cd0470f326dea3}{lIF}}.end();}
\DoxyCodeLine{00409\ \ \ \ \ \ \ )}
\DoxyCodeLine{00410\ \ \ \ \ \{}
\DoxyCodeLine{00411\ \ \ \ \ \ \ IF(i,0)\ =\ (*ifit);}
\DoxyCodeLine{00412\ \ \ \ \ \ \ ifit++;}
\DoxyCodeLine{00413\ \ \ \ \ \ \ IF(i,1)\ =\ (*ifit);}
\DoxyCodeLine{00414\ \ \ \ \ \ \ ifit++;}
\DoxyCodeLine{00415\ \ \ \ \ \ \ i++;}
\DoxyCodeLine{00416\ \ \ \ \ \}}
\DoxyCodeLine{00417\ \ \ \}}
\DoxyCodeLine{00418\ \textcolor{preprocessor}{\#ifdef\ IGL\_SELFINTERSECTMESH\_TIMING}}
\DoxyCodeLine{00419\ \ \ log\_time(\textcolor{stringliteral}{"{}store\_intersecting\_face\_pairs"{}});}
\DoxyCodeLine{00420\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00421\ }
\DoxyCodeLine{00422\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a4f0bfd48f1b39ab00b7fc5bf4e34733f}{params}}.\mbox{\hyperlink{structigl_1_1copyleft_1_1cgal_1_1RemeshSelfIntersectionsParam_a99e906696e0b6792b6c8b1c64a11072d}{detect\_only}})}
\DoxyCodeLine{00423\ \ \ \{}
\DoxyCodeLine{00424\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00425\ \ \ \}}
\DoxyCodeLine{00426\ }
\DoxyCodeLine{00427\ \ \ \mbox{\hyperlink{namespaceigl_1_1copyleft_1_1cgal_a99d687331f910fef280e3a0e5f5370c7}{remesh\_intersections}}(}
\DoxyCodeLine{00428\ \ \ \ \ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a93ef8bc8113137c9421d8599c420c6b7}{V}},\mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a3ffd426cf9b46ee61f0d189c52856313}{F}},\mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a5c0c06babba1e8ed96fec7d3b2a35204}{T}},\mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_af9bc58c53ef0b45d3b5ee56fe65e8554}{offending}},}
\DoxyCodeLine{00429\ \ \ \ \ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a4f0bfd48f1b39ab00b7fc5bf4e34733f}{params}}.\mbox{\hyperlink{structigl_1_1copyleft_1_1cgal_1_1RemeshSelfIntersectionsParam_ae1aa81388a94d26294c74a51ae3cf906}{stitch\_all}},\mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a4f0bfd48f1b39ab00b7fc5bf4e34733f}{params}}.\mbox{\hyperlink{structigl_1_1copyleft_1_1cgal_1_1RemeshSelfIntersectionsParam_a2e8863d911e7f8ef63354a70eea2b470}{slow\_and\_more\_precise\_rounding}},VV,FF,J,IM);}
\DoxyCodeLine{00430\ }
\DoxyCodeLine{00431\ \textcolor{preprocessor}{\#ifdef\ IGL\_SELFINTERSECTMESH\_TIMING}}
\DoxyCodeLine{00432\ \ \ log\_time(\textcolor{stringliteral}{"{}remesh\_intersection"{}});}
\DoxyCodeLine{00433\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00434\ \}}
\DoxyCodeLine{00435\ }
\DoxyCodeLine{00436\ }
\DoxyCodeLine{00437\ \textcolor{keyword}{template}\ <}
\DoxyCodeLine{00438\ \ \ \textcolor{keyword}{typename}\ Kernel,}
\DoxyCodeLine{00439\ \ \ \textcolor{keyword}{typename}\ DerivedV,}
\DoxyCodeLine{00440\ \ \ \textcolor{keyword}{typename}\ DerivedF,}
\DoxyCodeLine{00441\ \ \ \textcolor{keyword}{typename}\ DerivedVV,}
\DoxyCodeLine{00442\ \ \ \textcolor{keyword}{typename}\ DerivedFF,}
\DoxyCodeLine{00443\ \ \ \textcolor{keyword}{typename}\ DerivedIF,}
\DoxyCodeLine{00444\ \ \ \textcolor{keyword}{typename}\ DerivedJ,}
\DoxyCodeLine{00445\ \ \ \textcolor{keyword}{typename}\ DerivedIM>}
\DoxyCodeLine{00446\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh}{igl::copyleft::cgal::SelfIntersectMesh}}<}
\DoxyCodeLine{00447\ \ \ Kernel,}
\DoxyCodeLine{00448\ \ \ DerivedV,}
\DoxyCodeLine{00449\ \ \ DerivedF,}
\DoxyCodeLine{00450\ \ \ DerivedVV,}
\DoxyCodeLine{00451\ \ \ DerivedFF,}
\DoxyCodeLine{00452\ \ \ DerivedIF,}
\DoxyCodeLine{00453\ \ \ DerivedJ,}
\DoxyCodeLine{00454\ \ \ DerivedIM>::mark\_offensive(\textcolor{keyword}{const}\ Index\ f)}
\DoxyCodeLine{00455\ \{}
\DoxyCodeLine{00456\ \ \ \textcolor{keyword}{using\ namespace\ }std;}
\DoxyCodeLine{00457\ \ \ lIF.push\_back(f);}
\DoxyCodeLine{00458\ \ \ \textcolor{keywordflow}{if}(offending.count(f)\ ==\ 0)}
\DoxyCodeLine{00459\ \ \ \{}
\DoxyCodeLine{00460\ \ \ \ \ \textcolor{comment}{//\ first\ time\ marking,\ initialize\ with\ new\ id\ and\ empty\ list}}
\DoxyCodeLine{00461\ \ \ \ \ offending[f]\ =\ \{\};}
\DoxyCodeLine{00462\ \ \ \}}
\DoxyCodeLine{00463\ \}}
\DoxyCodeLine{00464\ }
\DoxyCodeLine{00465\ \textcolor{keyword}{template}\ <}
\DoxyCodeLine{00466\ \ \ \textcolor{keyword}{typename}\ Kernel,}
\DoxyCodeLine{00467\ \ \ \textcolor{keyword}{typename}\ DerivedV,}
\DoxyCodeLine{00468\ \ \ \textcolor{keyword}{typename}\ DerivedF,}
\DoxyCodeLine{00469\ \ \ \textcolor{keyword}{typename}\ DerivedVV,}
\DoxyCodeLine{00470\ \ \ \textcolor{keyword}{typename}\ DerivedFF,}
\DoxyCodeLine{00471\ \ \ \textcolor{keyword}{typename}\ DerivedIF,}
\DoxyCodeLine{00472\ \ \ \textcolor{keyword}{typename}\ DerivedJ,}
\DoxyCodeLine{00473\ \ \ \textcolor{keyword}{typename}\ DerivedIM>}
\DoxyCodeLine{00474\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh}{igl::copyleft::cgal::SelfIntersectMesh}}<}
\DoxyCodeLine{00475\ \ \ Kernel,}
\DoxyCodeLine{00476\ \ \ DerivedV,}
\DoxyCodeLine{00477\ \ \ DerivedF,}
\DoxyCodeLine{00478\ \ \ DerivedVV,}
\DoxyCodeLine{00479\ \ \ DerivedFF,}
\DoxyCodeLine{00480\ \ \ DerivedIF,}
\DoxyCodeLine{00481\ \ \ DerivedJ,}
\DoxyCodeLine{00482\ \ \ DerivedIM>::count\_intersection(}
\DoxyCodeLine{00483\ \ \ \textcolor{keyword}{const}\ Index\ fa,}
\DoxyCodeLine{00484\ \ \ \textcolor{keyword}{const}\ Index\ fb)}
\DoxyCodeLine{00485\ \{}
\DoxyCodeLine{00486\ \ \ std::lock\_guard<std::mutex>\ guard(m\_offending\_lock);}
\DoxyCodeLine{00487\ \ \ mark\_offensive(fa);}
\DoxyCodeLine{00488\ \ \ mark\_offensive(fb);}
\DoxyCodeLine{00489\ \ \ this-\/>\mbox{\hyperlink{namespaceigl_a83819bb842f4bc4c8af21a98e1db44b3}{count}}++;}
\DoxyCodeLine{00490\ \ \ \textcolor{comment}{//\ We\ found\ the\ first\ intersection}}
\DoxyCodeLine{00491\ \ \ \textcolor{keywordflow}{if}(params.first\_only\ \&\&\ this-\/>count\ >=\ 1)}
\DoxyCodeLine{00492\ \ \ \{}
\DoxyCodeLine{00493\ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{SelfIntersectMesh_8h_a80fe8a5758f21b2e4e9eee2ed44a2f2e}{IGL\_FIRST\_HIT\_EXCEPTION}};}
\DoxyCodeLine{00494\ \ \ \}}
\DoxyCodeLine{00495\ }
\DoxyCodeLine{00496\ \}}
\DoxyCodeLine{00497\ }
\DoxyCodeLine{00498\ \textcolor{keyword}{template}\ <}
\DoxyCodeLine{00499\ \ \ \textcolor{keyword}{typename}\ Kernel,}
\DoxyCodeLine{00500\ \ \ \textcolor{keyword}{typename}\ DerivedV,}
\DoxyCodeLine{00501\ \ \ \textcolor{keyword}{typename}\ DerivedF,}
\DoxyCodeLine{00502\ \ \ \textcolor{keyword}{typename}\ DerivedVV,}
\DoxyCodeLine{00503\ \ \ \textcolor{keyword}{typename}\ DerivedFF,}
\DoxyCodeLine{00504\ \ \ \textcolor{keyword}{typename}\ DerivedIF,}
\DoxyCodeLine{00505\ \ \ \textcolor{keyword}{typename}\ DerivedJ,}
\DoxyCodeLine{00506\ \ \ \textcolor{keyword}{typename}\ DerivedIM>}
\DoxyCodeLine{00507\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh}{igl::copyleft::cgal::SelfIntersectMesh}}<}
\DoxyCodeLine{00508\ \ \ Kernel,}
\DoxyCodeLine{00509\ \ \ DerivedV,}
\DoxyCodeLine{00510\ \ \ DerivedF,}
\DoxyCodeLine{00511\ \ \ DerivedVV,}
\DoxyCodeLine{00512\ \ \ DerivedFF,}
\DoxyCodeLine{00513\ \ \ DerivedIF,}
\DoxyCodeLine{00514\ \ \ DerivedJ,}
\DoxyCodeLine{00515\ \ \ DerivedIM>\mbox{\hyperlink{namespaceigl_a4f72acbb659a5c1d291a4cff36910a87}{::intersect}}(}
\DoxyCodeLine{00516\ \ \ \textcolor{keyword}{const}\ Triangle\_3\ \&\ A,}
\DoxyCodeLine{00517\ \ \ \textcolor{keyword}{const}\ Triangle\_3\ \&\ B,}
\DoxyCodeLine{00518\ \ \ \textcolor{keyword}{const}\ Index\ fa,}
\DoxyCodeLine{00519\ \ \ \textcolor{keyword}{const}\ Index\ fb)}
\DoxyCodeLine{00520\ \{}
\DoxyCodeLine{00521\ \ \ \textcolor{comment}{//\ Determine\ whether\ there\ is\ an\ intersection}}
\DoxyCodeLine{00522\ \ \ \textcolor{keywordflow}{if}(!CGAL::do\_intersect(A,B))}
\DoxyCodeLine{00523\ \ \ \{}
\DoxyCodeLine{00524\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00525\ \ \ \}}
\DoxyCodeLine{00526\ \ \ count\_intersection(fa,fb);}
\DoxyCodeLine{00527\ \ \ \textcolor{keywordflow}{if}(!params.detect\_only)}
\DoxyCodeLine{00528\ \ \ \{}
\DoxyCodeLine{00529\ \ \ \ \ \textcolor{comment}{//\ Construct\ intersection}}
\DoxyCodeLine{00530\ \ \ \ \ CGAL::Object\ result\ =\ CGAL::intersection(A,B);}
\DoxyCodeLine{00531\ \ \ \ \ \textcolor{comment}{//\ Could\ avoid\ this\ mutex\ if\ \`{}offending`\ was\ per-\/thread\ and\ passed\ as\ input}}
\DoxyCodeLine{00532\ \ \ \ \ \textcolor{comment}{//\ reference.}}
\DoxyCodeLine{00533\ \ \ \ \ std::lock\_guard<std::mutex>\ guard(m\_offending\_lock);}
\DoxyCodeLine{00534\ \ \ \ \ offending[fa].push\_back(\{fb,\ result\});}
\DoxyCodeLine{00535\ \ \ \ \ offending[fb].push\_back(\{fa,\ result\});}
\DoxyCodeLine{00536\ \ \ \}}
\DoxyCodeLine{00537\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00538\ \}}
\DoxyCodeLine{00539\ }
\DoxyCodeLine{00540\ \textcolor{keyword}{template}\ <}
\DoxyCodeLine{00541\ \ \ \textcolor{keyword}{typename}\ Kernel,}
\DoxyCodeLine{00542\ \ \ \textcolor{keyword}{typename}\ DerivedV,}
\DoxyCodeLine{00543\ \ \ \textcolor{keyword}{typename}\ DerivedF,}
\DoxyCodeLine{00544\ \ \ \textcolor{keyword}{typename}\ DerivedVV,}
\DoxyCodeLine{00545\ \ \ \textcolor{keyword}{typename}\ DerivedFF,}
\DoxyCodeLine{00546\ \ \ \textcolor{keyword}{typename}\ DerivedIF,}
\DoxyCodeLine{00547\ \ \ \textcolor{keyword}{typename}\ DerivedJ,}
\DoxyCodeLine{00548\ \ \ \textcolor{keyword}{typename}\ DerivedIM>}
\DoxyCodeLine{00549\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh}{igl::copyleft::cgal::SelfIntersectMesh}}<}
\DoxyCodeLine{00550\ \ \ Kernel,}
\DoxyCodeLine{00551\ \ \ DerivedV,}
\DoxyCodeLine{00552\ \ \ DerivedF,}
\DoxyCodeLine{00553\ \ \ DerivedVV,}
\DoxyCodeLine{00554\ \ \ DerivedFF,}
\DoxyCodeLine{00555\ \ \ DerivedIF,}
\DoxyCodeLine{00556\ \ \ DerivedJ,}
\DoxyCodeLine{00557\ \ \ DerivedIM>::single\_shared\_vertex(}
\DoxyCodeLine{00558\ \ \ \textcolor{keyword}{const}\ Triangle\_3\ \&\ A,}
\DoxyCodeLine{00559\ \ \ \textcolor{keyword}{const}\ Triangle\_3\ \&\ B,}
\DoxyCodeLine{00560\ \ \ \textcolor{keyword}{const}\ Index\ fa,}
\DoxyCodeLine{00561\ \ \ \textcolor{keyword}{const}\ Index\ fb,}
\DoxyCodeLine{00562\ \ \ \textcolor{keyword}{const}\ Index\ va,}
\DoxyCodeLine{00563\ \ \ \textcolor{keyword}{const}\ Index\ vb)}
\DoxyCodeLine{00564\ \{}
\DoxyCodeLine{00565\ \ \ \textcolor{keywordflow}{if}(single\_shared\_vertex(A,B,fa,fb,va))}
\DoxyCodeLine{00566\ \ \ \{}
\DoxyCodeLine{00567\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00568\ \ \ \}}
\DoxyCodeLine{00569\ \ \ \textcolor{keywordflow}{return}\ single\_shared\_vertex(B,A,fb,fa,vb);}
\DoxyCodeLine{00570\ \}}
\DoxyCodeLine{00571\ }
\DoxyCodeLine{00572\ \textcolor{keyword}{template}\ <}
\DoxyCodeLine{00573\ \ \ \textcolor{keyword}{typename}\ Kernel,}
\DoxyCodeLine{00574\ \ \ \textcolor{keyword}{typename}\ DerivedV,}
\DoxyCodeLine{00575\ \ \ \textcolor{keyword}{typename}\ DerivedF,}
\DoxyCodeLine{00576\ \ \ \textcolor{keyword}{typename}\ DerivedVV,}
\DoxyCodeLine{00577\ \ \ \textcolor{keyword}{typename}\ DerivedFF,}
\DoxyCodeLine{00578\ \ \ \textcolor{keyword}{typename}\ DerivedIF,}
\DoxyCodeLine{00579\ \ \ \textcolor{keyword}{typename}\ DerivedJ,}
\DoxyCodeLine{00580\ \ \ \textcolor{keyword}{typename}\ DerivedIM>}
\DoxyCodeLine{00581\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh}{igl::copyleft::cgal::SelfIntersectMesh}}<}
\DoxyCodeLine{00582\ \ \ Kernel,}
\DoxyCodeLine{00583\ \ \ DerivedV,}
\DoxyCodeLine{00584\ \ \ DerivedF,}
\DoxyCodeLine{00585\ \ \ DerivedVV,}
\DoxyCodeLine{00586\ \ \ DerivedFF,}
\DoxyCodeLine{00587\ \ \ DerivedIF,}
\DoxyCodeLine{00588\ \ \ DerivedJ,}
\DoxyCodeLine{00589\ \ \ DerivedIM>::single\_shared\_vertex(}
\DoxyCodeLine{00590\ \ \ \textcolor{keyword}{const}\ Triangle\_3\ \&\ A,}
\DoxyCodeLine{00591\ \ \ \textcolor{keyword}{const}\ Triangle\_3\ \&\ B,}
\DoxyCodeLine{00592\ \ \ \textcolor{keyword}{const}\ Index\ fa,}
\DoxyCodeLine{00593\ \ \ \textcolor{keyword}{const}\ Index\ fb,}
\DoxyCodeLine{00594\ \ \ \textcolor{keyword}{const}\ Index\ va)}
\DoxyCodeLine{00595\ \{}
\DoxyCodeLine{00596\ \ \ \textcolor{comment}{//\ This\ was\ not\ a\ good\ idea.\ It\ will\ not\ handle\ coplanar\ triangles\ well.}}
\DoxyCodeLine{00597\ \ \ \textcolor{keyword}{using\ namespace\ }std;}
\DoxyCodeLine{00598\ \ \ Segment\_3\ sa(}
\DoxyCodeLine{00599\ \ \ \ \ A.vertex((va+1)\%3),}
\DoxyCodeLine{00600\ \ \ \ \ A.vertex((va+2)\%3));}
\DoxyCodeLine{00601\ }
\DoxyCodeLine{00602\ \ \ \textcolor{keywordflow}{if}(CGAL::do\_intersect(sa,B))}
\DoxyCodeLine{00603\ \ \ \{}
\DoxyCodeLine{00604\ \ \ \ \ \textcolor{comment}{//\ can't\ put\ count\_intersection(fa,fb)\ here\ since\ we\ use\ intersect\ below}}
\DoxyCodeLine{00605\ \ \ \ \ \textcolor{comment}{//\ and\ then\ it\ will\ be\ counted\ twice.}}
\DoxyCodeLine{00606\ \ \ \ \ \textcolor{keywordflow}{if}(params.detect\_only)}
\DoxyCodeLine{00607\ \ \ \ \ \{}
\DoxyCodeLine{00608\ \ \ \ \ \ \ count\_intersection(fa,fb);}
\DoxyCodeLine{00609\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00610\ \ \ \ \ \}}
\DoxyCodeLine{00611\ \ \ \ \ CGAL::Object\ result\ =\ CGAL::intersection(sa,B);}
\DoxyCodeLine{00612\ \ \ \ \ \textcolor{keywordflow}{if}(\textcolor{keyword}{const}\ Point\_3\ *\ p\ =\ CGAL::object\_cast<Point\_3\ >(\&result))}
\DoxyCodeLine{00613\ \ \ \ \ \{}
\DoxyCodeLine{00614\ \ \ \ \ \ \ \textcolor{comment}{//\ Single\ intersection\ -\/-\/>\ segment\ from\ shared\ point\ to\ intersection}}
\DoxyCodeLine{00615\ \ \ \ \ \ \ CGAL::Object\ seg\ =\ CGAL::make\_object(Segment\_3(}
\DoxyCodeLine{00616\ \ \ \ \ \ \ \ \ A.vertex(va),}
\DoxyCodeLine{00617\ \ \ \ \ \ \ \ \ *p));}
\DoxyCodeLine{00618\ \ \ \ \ \ \ count\_intersection(fa,fb);}
\DoxyCodeLine{00619\ \ \ \ \ \ \ std::lock\_guard<std::mutex>\ guard(m\_offending\_lock);}
\DoxyCodeLine{00620\ \ \ \ \ \ \ offending[fa].push\_back(\{fb,\ seg\});}
\DoxyCodeLine{00621\ \ \ \ \ \ \ offending[fb].push\_back(\{fa,\ seg\});}
\DoxyCodeLine{00622\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00623\ \ \ \ \ \}\textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(CGAL::object\_cast<Segment\_3\ >(\&result))}
\DoxyCodeLine{00624\ \ \ \ \ \{}
\DoxyCodeLine{00625\ \ \ \ \ \ \ \textcolor{comment}{//\ Need\ to\ do\ full\ test.\ Intersection\ could\ be\ a\ general\ poly.}}
\DoxyCodeLine{00626\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ test\ =\ \mbox{\hyperlink{namespaceigl_a4f72acbb659a5c1d291a4cff36910a87}{intersect}}(A,B,fa,fb);}
\DoxyCodeLine{00627\ \ \ \ \ \ \ ((void)test);}
\DoxyCodeLine{00628\ \ \ \ \ \ \ assert(test\ \&\&\ \textcolor{stringliteral}{"{}intersect\ should\ agree\ with\ do\_intersect"{}});}
\DoxyCodeLine{00629\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00630\ \ \ \ \ \}\textcolor{keywordflow}{else}}
\DoxyCodeLine{00631\ \ \ \ \ \{}
\DoxyCodeLine{00632\ \ \ \ \ \ \ \textcolor{comment}{//\ Should\ never\ happen.}}
\DoxyCodeLine{00633\ \ \ \ \ \ \ assert(\textcolor{keyword}{false}\ \&\&\ \textcolor{stringliteral}{"{}Segment\ ∩\ triangle\ neither\ point\ nor\ segment?"{}});}
\DoxyCodeLine{00634\ \ \ \ \ \}}
\DoxyCodeLine{00635\ \ \ \}}
\DoxyCodeLine{00636\ }
\DoxyCodeLine{00637\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00638\ \}}
\DoxyCodeLine{00639\ }
\DoxyCodeLine{00640\ }
\DoxyCodeLine{00641\ \textcolor{keyword}{template}\ <}
\DoxyCodeLine{00642\ \ \ \textcolor{keyword}{typename}\ Kernel,}
\DoxyCodeLine{00643\ \ \ \textcolor{keyword}{typename}\ DerivedV,}
\DoxyCodeLine{00644\ \ \ \textcolor{keyword}{typename}\ DerivedF,}
\DoxyCodeLine{00645\ \ \ \textcolor{keyword}{typename}\ DerivedVV,}
\DoxyCodeLine{00646\ \ \ \textcolor{keyword}{typename}\ DerivedFF,}
\DoxyCodeLine{00647\ \ \ \textcolor{keyword}{typename}\ DerivedIF,}
\DoxyCodeLine{00648\ \ \ \textcolor{keyword}{typename}\ DerivedJ,}
\DoxyCodeLine{00649\ \ \ \textcolor{keyword}{typename}\ DerivedIM>}
\DoxyCodeLine{00650\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh}{igl::copyleft::cgal::SelfIntersectMesh}}<}
\DoxyCodeLine{00651\ \ \ Kernel,}
\DoxyCodeLine{00652\ \ \ DerivedV,}
\DoxyCodeLine{00653\ \ \ DerivedF,}
\DoxyCodeLine{00654\ \ \ DerivedVV,}
\DoxyCodeLine{00655\ \ \ DerivedFF,}
\DoxyCodeLine{00656\ \ \ DerivedIF,}
\DoxyCodeLine{00657\ \ \ DerivedJ,}
\DoxyCodeLine{00658\ \ \ DerivedIM>::double\_shared\_vertex(}
\DoxyCodeLine{00659\ \ \ \textcolor{keyword}{const}\ Triangle\_3\ \&\ A,}
\DoxyCodeLine{00660\ \ \ \textcolor{keyword}{const}\ Triangle\_3\ \&\ B,}
\DoxyCodeLine{00661\ \ \ \textcolor{keyword}{const}\ Index\ fa,}
\DoxyCodeLine{00662\ \ \ \textcolor{keyword}{const}\ Index\ fb,}
\DoxyCodeLine{00663\ \ \ \textcolor{keyword}{const}\ std::vector<std::pair<Index,Index>\ >\ shared)}
\DoxyCodeLine{00664\ \{}
\DoxyCodeLine{00665\ \ \ \textcolor{keyword}{using\ namespace\ }std;}
\DoxyCodeLine{00666\ }
\DoxyCodeLine{00667\ \ \ \textcolor{keyword}{auto}\ opposite\_vertex\ =\ [](\textcolor{keyword}{const}\ Index\ a0,\ \textcolor{keyword}{const}\ Index\ a1)\ \{}
\DoxyCodeLine{00668\ \ \ \ \ \textcolor{comment}{//\ get\ opposite\ index\ of\ A}}
\DoxyCodeLine{00669\ \ \ \ \ \textcolor{keywordtype}{int}\ a2=-\/1;}
\DoxyCodeLine{00670\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ c=0;c<3;++c)}
\DoxyCodeLine{00671\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(c!=a0\ \&\&\ c!=a1)\ \{}
\DoxyCodeLine{00672\ \ \ \ \ \ \ \ \ a2\ =\ c;}
\DoxyCodeLine{00673\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00674\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00675\ \ \ \ \ \ \ assert(a2\ !=\ -\/1);}
\DoxyCodeLine{00676\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ a2;}
\DoxyCodeLine{00677\ \ \ \};}
\DoxyCodeLine{00678\ }
\DoxyCodeLine{00679\ \ \ \textcolor{comment}{//\ must\ be\ co-\/planar}}
\DoxyCodeLine{00680\ \ \ Index\ a2\ =\ opposite\_vertex(shared[0].first,\ shared[1].first);}
\DoxyCodeLine{00681\ \ \ \textcolor{keywordflow}{if}\ (!\ B.supporting\_plane().has\_on(A.vertex(a2)))}
\DoxyCodeLine{00682\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00683\ \ \ }
\DoxyCodeLine{00684\ \ \ Index\ b2\ =\ opposite\_vertex(shared[0].second,\ shared[1].second);}
\DoxyCodeLine{00685\ }
\DoxyCodeLine{00686\ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keywordtype}{int}(CGAL::coplanar\_orientation(A.vertex(shared[0].first),\ A.vertex(shared[1].first),\ A.vertex(a2)))\ *\ }
\DoxyCodeLine{00687\ \ \ \ \ \ \ \textcolor{keywordtype}{int}(CGAL::coplanar\_orientation(B.vertex(shared[0].second),\ B.vertex(shared[1].second),\ B.vertex(b2)))\ <\ 0)}
\DoxyCodeLine{00688\ \ \ \ \ \textcolor{comment}{//\ There\ is\ certainly\ no\ self\ intersection\ as\ the\ non-\/shared\ triangle\ vertices\ lie\ on\ opposite\ sides\ of\ the\ shared\ edge.}}
\DoxyCodeLine{00689\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00690\ }
\DoxyCodeLine{00691\ \ \ \textcolor{comment}{//\ Since\ A\ and\ B\ are\ non-\/degenerate\ the\ intersection\ must\ be\ a\ polygon}}
\DoxyCodeLine{00692\ \ \ \textcolor{comment}{//\ (triangle).\ Either}}
\DoxyCodeLine{00693\ \ \ \textcolor{comment}{//\ \ \ -\/\ the\ vertex\ of\ A\ (B)\ opposite\ the\ shared\ edge\ of\ lies\ on\ B\ (A),\ or}}
\DoxyCodeLine{00694\ \ \ \textcolor{comment}{//\ \ \ -\/\ an\ edge\ of\ A\ intersects\ and\ edge\ of\ B\ without\ sharing\ a\ vertex}}
\DoxyCodeLine{00695\ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00696\ \ \ \textcolor{comment}{//\ Determine\ if\ the\ vertex\ opposite\ edge\ (a0,a1)\ in\ triangle\ A\ lies\ in}}
\DoxyCodeLine{00697\ \ \ \textcolor{comment}{//\ (intersects)\ triangle\ B}}
\DoxyCodeLine{00698\ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ \&\ opposite\_point\_inside\ =\ [](}
\DoxyCodeLine{00699\ \ \ \ \ \textcolor{keyword}{const}\ Triangle\_3\ \&\ A,\ \textcolor{keyword}{const}\ Index\ a2,\ \textcolor{keyword}{const}\ Triangle\_3\ \&\ B)\ }
\DoxyCodeLine{00700\ \ \ \ \ -\/>\ \textcolor{keywordtype}{bool}}
\DoxyCodeLine{00701\ \ \ \{}
\DoxyCodeLine{00702\ \ \ \ \ \textcolor{keywordflow}{return}\ CGAL::do\_intersect(A.vertex(a2),B);}
\DoxyCodeLine{00703\ \ \ \};}
\DoxyCodeLine{00704\ }
\DoxyCodeLine{00705\ \ \ \textcolor{comment}{//\ Determine\ if\ edge\ opposite\ vertex\ va\ in\ triangle\ A\ intersects\ edge}}
\DoxyCodeLine{00706\ \ \ \textcolor{comment}{//\ opposite\ vertex\ vb\ in\ triangle\ B.}}
\DoxyCodeLine{00707\ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ \&\ opposite\_edges\_intersect\ =\ [](}
\DoxyCodeLine{00708\ \ \ \ \ \textcolor{keyword}{const}\ Triangle\_3\ \&\ A,\ \textcolor{keyword}{const}\ Index\ va,}
\DoxyCodeLine{00709\ \ \ \ \ \textcolor{keyword}{const}\ Triangle\_3\ \&\ B,\ \textcolor{keyword}{const}\ Index\ vb)\ -\/>\ \textcolor{keywordtype}{bool}}
\DoxyCodeLine{00710\ \ \ \{}
\DoxyCodeLine{00711\ \ \ \ \ Segment\_3\ sa(\ A.vertex((va+1)\%3),\ A.vertex((va+2)\%3));}
\DoxyCodeLine{00712\ \ \ \ \ Segment\_3\ sb(\ B.vertex((vb+1)\%3),\ B.vertex((vb+2)\%3));}
\DoxyCodeLine{00713\ \ \ \ \ \textcolor{keywordtype}{bool}\ ret\ =\ CGAL::do\_intersect(sa,sb);}
\DoxyCodeLine{00714\ \ \ \ \ \textcolor{keywordflow}{return}\ ret;}
\DoxyCodeLine{00715\ \ \ \};}
\DoxyCodeLine{00716\ }
\DoxyCodeLine{00717\ \ \ \textcolor{keywordflow}{if}(\ }
\DoxyCodeLine{00718\ \ \ \ \ !opposite\_point\_inside(A,a2,B)\ \&\&}
\DoxyCodeLine{00719\ \ \ \ \ !opposite\_point\_inside(B,b2,A)\ \&\&}
\DoxyCodeLine{00720\ \ \ \ \ !opposite\_edges\_intersect(A,shared[0].first,B,shared[1].second)\ \&\&\ }
\DoxyCodeLine{00721\ \ \ \ \ !opposite\_edges\_intersect(A,shared[1].first,B,shared[0].second))}
\DoxyCodeLine{00722\ \ \ \{}
\DoxyCodeLine{00723\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00724\ \ \ \}}
\DoxyCodeLine{00725\ }
\DoxyCodeLine{00726\ \ \ \textcolor{comment}{//\ there\ is\ an\ intersection\ indeed}}
\DoxyCodeLine{00727\ \ \ count\_intersection(fa,fb);}
\DoxyCodeLine{00728\ \ \ \textcolor{keywordflow}{if}(params.detect\_only)}
\DoxyCodeLine{00729\ \ \ \{}
\DoxyCodeLine{00730\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00731\ \ \ \}}
\DoxyCodeLine{00732\ \ \ \textcolor{comment}{//\ Construct\ intersection}}
\DoxyCodeLine{00733\ \ \ \textcolor{keywordflow}{try}}
\DoxyCodeLine{00734\ \ \ \{}
\DoxyCodeLine{00735\ \ \ \ \ \textcolor{comment}{//\ This\ can\ fail\ for\ Epick\ but\ not\ Epeck}}
\DoxyCodeLine{00736\ \ \ \ \ CGAL::Object\ result\ =\ CGAL::intersection(A,B);}
\DoxyCodeLine{00737\ \ \ \ \ \textcolor{keywordflow}{if}(!result.empty())}
\DoxyCodeLine{00738\ \ \ \ \ \{}
\DoxyCodeLine{00739\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(CGAL::object\_cast<Segment\_3\ >(\&result))}
\DoxyCodeLine{00740\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00741\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ not\ coplanar}}
\DoxyCodeLine{00742\ \ \ \ \ \ \ \ \ assert(\textcolor{keyword}{false}\ \&\&}
\DoxyCodeLine{00743\ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Co-\/planar\ non-\/degenerate\ triangles\ should\ intersect\ over\ triangle"{}});}
\DoxyCodeLine{00744\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00745\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(CGAL::object\_cast<Point\_3\ >(\&result))}
\DoxyCodeLine{00746\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00747\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ this\ "{}shouldn't"{}\ happen\ but\ does\ for\ inexact}}
\DoxyCodeLine{00748\ \ \ \ \ \ \ \ \ assert(\textcolor{keyword}{false}\ \&\&}
\DoxyCodeLine{00749\ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Co-\/planar\ non-\/degenerate\ triangles\ should\ intersect\ over\ triangle"{}});}
\DoxyCodeLine{00750\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00751\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00752\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00753\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Triangle\ object}}
\DoxyCodeLine{00754\ \ \ \ \ \ \ \ \ std::lock\_guard<std::mutex>\ guard(m\_offending\_lock);}
\DoxyCodeLine{00755\ \ \ \ \ \ \ \ \ offending[fa].push\_back(\{fb,\ result\});}
\DoxyCodeLine{00756\ \ \ \ \ \ \ \ \ offending[fb].push\_back(\{fa,\ result\});}
\DoxyCodeLine{00757\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00758\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00759\ \ \ \ \ \}\textcolor{keywordflow}{else}}
\DoxyCodeLine{00760\ \ \ \ \ \{}
\DoxyCodeLine{00761\ \ \ \ \ \ \ \textcolor{comment}{//\ CGAL::intersection\ is\ disagreeing\ with\ do\_intersect}}
\DoxyCodeLine{00762\ \ \ \ \ \ \ assert(\textcolor{keyword}{false}\ \&\&\ \textcolor{stringliteral}{"{}CGAL::intersection\ should\ agree\ with\ predicate\ tests"{}});}
\DoxyCodeLine{00763\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00764\ \ \ \ \ \}}
\DoxyCodeLine{00765\ \ \ \}\textcolor{keywordflow}{catch}(...)}
\DoxyCodeLine{00766\ \ \ \{}
\DoxyCodeLine{00767\ \ \ \ \ \textcolor{comment}{//\ This\ catches\ some\ cgal\ assertion:}}
\DoxyCodeLine{00768\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ CGAL\ error:\ assertion\ violation!}}
\DoxyCodeLine{00769\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ Expression\ :\ is\_finite(d)}}
\DoxyCodeLine{00770\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ File\ \ \ \ \ \ \ :\ /opt/local/include/CGAL/GMP/Gmpq\_type.h}}
\DoxyCodeLine{00771\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ Line\ \ \ \ \ \ \ :\ 132}}
\DoxyCodeLine{00772\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ Explanation:}}
\DoxyCodeLine{00773\ \ \ \ \ \textcolor{comment}{//\ But\ only\ if\ NDEBUG\ is\ not\ defined,\ otherwise\ there's\ an\ uncaught}}
\DoxyCodeLine{00774\ \ \ \ \ \textcolor{comment}{//\ "{}Floating\ point\ exception:\ 8"{}\ SIGFPE}}
\DoxyCodeLine{00775\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00776\ \ \ \}}
\DoxyCodeLine{00777\ \ \ \textcolor{comment}{//\ No\ intersection.}}
\DoxyCodeLine{00778\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00779\ \}}
\DoxyCodeLine{00780\ }
\DoxyCodeLine{00781\ \textcolor{keyword}{template}\ <}
\DoxyCodeLine{00782\ \ \ \textcolor{keyword}{typename}\ Kernel,}
\DoxyCodeLine{00783\ \ \ \textcolor{keyword}{typename}\ DerivedV,}
\DoxyCodeLine{00784\ \ \ \textcolor{keyword}{typename}\ DerivedF,}
\DoxyCodeLine{00785\ \ \ \textcolor{keyword}{typename}\ DerivedVV,}
\DoxyCodeLine{00786\ \ \ \textcolor{keyword}{typename}\ DerivedFF,}
\DoxyCodeLine{00787\ \ \ \textcolor{keyword}{typename}\ DerivedIF,}
\DoxyCodeLine{00788\ \ \ \textcolor{keyword}{typename}\ DerivedJ,}
\DoxyCodeLine{00789\ \ \ \textcolor{keyword}{typename}\ DerivedIM>}
\DoxyCodeLine{00790\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh}{igl::copyleft::cgal::SelfIntersectMesh}}<}
\DoxyCodeLine{00791\ \ \ Kernel,}
\DoxyCodeLine{00792\ \ \ DerivedV,}
\DoxyCodeLine{00793\ \ \ DerivedF,}
\DoxyCodeLine{00794\ \ \ DerivedVV,}
\DoxyCodeLine{00795\ \ \ DerivedFF,}
\DoxyCodeLine{00796\ \ \ DerivedIF,}
\DoxyCodeLine{00797\ \ \ DerivedJ,}
\DoxyCodeLine{00798\ \ \ DerivedIM>::box\_intersect(}
\DoxyCodeLine{00799\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a3ecb2a1e8a582bfc5a0be109bc6a0afd}{Box}}\&\ a,}
\DoxyCodeLine{00800\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a3ecb2a1e8a582bfc5a0be109bc6a0afd}{Box}}\&\ b)}
\DoxyCodeLine{00801\ \{}
\DoxyCodeLine{00802\ \ \ candidate\_triangle\_pairs.push\_back(\{a.handle(),\ b.handle()\});}
\DoxyCodeLine{00803\ \}}
\DoxyCodeLine{00804\ }
\DoxyCodeLine{00805\ \textcolor{keyword}{template}\ <}
\DoxyCodeLine{00806\ \ \ \textcolor{keyword}{typename}\ Kernel,}
\DoxyCodeLine{00807\ \ \ \textcolor{keyword}{typename}\ DerivedV,}
\DoxyCodeLine{00808\ \ \ \textcolor{keyword}{typename}\ DerivedF,}
\DoxyCodeLine{00809\ \ \ \textcolor{keyword}{typename}\ DerivedVV,}
\DoxyCodeLine{00810\ \ \ \textcolor{keyword}{typename}\ DerivedFF,}
\DoxyCodeLine{00811\ \ \ \textcolor{keyword}{typename}\ DerivedIF,}
\DoxyCodeLine{00812\ \ \ \textcolor{keyword}{typename}\ DerivedJ,}
\DoxyCodeLine{00813\ \ \ \textcolor{keyword}{typename}\ DerivedIM>}
\DoxyCodeLine{00814\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh}{igl::copyleft::cgal::SelfIntersectMesh}}<}
\DoxyCodeLine{00815\ \ \ Kernel,}
\DoxyCodeLine{00816\ \ \ DerivedV,}
\DoxyCodeLine{00817\ \ \ DerivedF,}
\DoxyCodeLine{00818\ \ \ DerivedVV,}
\DoxyCodeLine{00819\ \ \ DerivedFF,}
\DoxyCodeLine{00820\ \ \ DerivedIF,}
\DoxyCodeLine{00821\ \ \ DerivedJ,}
\DoxyCodeLine{00822\ \ \ DerivedIM>::process\_intersecting\_boxes()}
\DoxyCodeLine{00823\ \{}
\DoxyCodeLine{00824\ \ \ std::mutex\ exception\_mutex;}
\DoxyCodeLine{00825\ \ \ \textcolor{keywordtype}{bool}\ exception\_fired\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00826\ \ \ \textcolor{keywordtype}{int}\ exception\ =\ -\/1;}
\DoxyCodeLine{00827\ \ \ \textcolor{comment}{//\ Eventually\ switching\ to\ igl::parallel\_for\ would\ be\ good,\ but\ currently}}
\DoxyCodeLine{00828\ \ \ \textcolor{comment}{//\ igl::parallel\_for\ does\ not\ provide\ a\ way\ to\ catch\ exceptions\ fired\ on\ a}}
\DoxyCodeLine{00829\ \ \ \textcolor{comment}{//\ spawned\ thread\ \_outside\_\ of\ its\ loop-\/chunk\ which\ is\ the\ mechanism\ used\ here}}
\DoxyCodeLine{00830\ \ \ \textcolor{comment}{//\ to\ bail\ out\ early\ when\ \`{}first\_only=true`\ to\ avoid}}
\DoxyCodeLine{00831\ \ \ \textcolor{comment}{//\ O(\#candidate\_triangle\_pairs)\ behavior.}}
\DoxyCodeLine{00832\ \ \ \textcolor{keyword}{auto}\ process\_chunk\ =\ [\&](\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ first,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ last)\ -\/>\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00833\ \ \ \{}
\DoxyCodeLine{00834\ \ \ \ \ \textcolor{keywordflow}{try}}
\DoxyCodeLine{00835\ \ \ \ \ \{}
\DoxyCodeLine{00836\ \ \ \ \ \ \ assert(last\ >=\ first);}
\DoxyCodeLine{00837\ }
\DoxyCodeLine{00838\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i=first;\ i<last;\ i++)}
\DoxyCodeLine{00839\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00840\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(exception\_fired)\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00841\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a3be180f5be3130421d1df3738caa3922}{Index}}\ fa=T.size(),\ fb=T.size();}
\DoxyCodeLine{00842\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00843\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ tri\_pair\ =\ candidate\_triangle\_pairs[i];}
\DoxyCodeLine{00844\ \ \ \ \ \ \ \ \ \ \ fa\ =\ tri\_pair.first\ -\/\ T.begin();}
\DoxyCodeLine{00845\ \ \ \ \ \ \ \ \ \ \ fb\ =\ tri\_pair.second\ -\/\ T.begin();}
\DoxyCodeLine{00846\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00847\ \ \ \ \ \ \ \ \ assert(fa\ <\ T.size());}
\DoxyCodeLine{00848\ \ \ \ \ \ \ \ \ assert(fb\ <\ T.size());}
\DoxyCodeLine{00849\ }
\DoxyCodeLine{00850\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(exception\_fired)\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00851\ }
\DoxyCodeLine{00852\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a08b88627a638dec1767ad4964dae7fe7}{Triangle\_3}}\&\ A\ =\ T[fa];}
\DoxyCodeLine{00853\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a08b88627a638dec1767ad4964dae7fe7}{Triangle\_3}}\&\ B\ =\ T[fb];}
\DoxyCodeLine{00854\ }
\DoxyCodeLine{00855\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Number\ of\ combinatorially\ shared\ vertices}}
\DoxyCodeLine{00856\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a3be180f5be3130421d1df3738caa3922}{Index}}\ comb\_shared\_vertices\ =\ 0;}
\DoxyCodeLine{00857\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Number\ of\ geometrically\ shared\ vertices\ (*not*\ including}}
\DoxyCodeLine{00858\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ combinatorially\ shared)}}
\DoxyCodeLine{00859\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a3be180f5be3130421d1df3738caa3922}{Index}}\ geo\_shared\_vertices\ =\ 0;}
\DoxyCodeLine{00860\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Keep\ track\ of\ shared\ vertex\ indices}}
\DoxyCodeLine{00861\ \ \ \ \ \ \ \ \ std::vector<std::pair<Index,Index>\ >\ shared;}
\DoxyCodeLine{00862\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a3be180f5be3130421d1df3738caa3922}{Index}}\ ea,eb;}
\DoxyCodeLine{00863\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(ea=0;ea<3;ea++)}
\DoxyCodeLine{00864\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00865\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(eb=0;eb<3;eb++)}
\DoxyCodeLine{00866\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00867\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(F(fa,ea)\ ==\ F(fb,eb))}
\DoxyCodeLine{00868\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00869\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ comb\_shared\_vertices++;}
\DoxyCodeLine{00870\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ shared.emplace\_back(ea,eb);}
\DoxyCodeLine{00871\ \ \ \ \ \ \ \ \ \ \ \ \ \}\textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(A.vertex(ea)\ ==\ B.vertex(eb))}
\DoxyCodeLine{00872\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00873\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ geo\_shared\_vertices++;}
\DoxyCodeLine{00874\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ shared.emplace\_back(ea,eb);}
\DoxyCodeLine{00875\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00876\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00877\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00878\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classigl_1_1copyleft_1_1cgal_1_1SelfIntersectMesh_a3be180f5be3130421d1df3738caa3922}{Index}}\ total\_shared\_vertices\ =}
\DoxyCodeLine{00879\ \ \ \ \ \ \ \ \ \ \ comb\_shared\_vertices\ +\ geo\_shared\_vertices;}
\DoxyCodeLine{00880\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(exception\_fired)\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00881\ }
\DoxyCodeLine{00882\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(comb\_shared\_vertices==\ 3)}
\DoxyCodeLine{00883\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00884\ \ \ \ \ \ \ \ \ \ \ assert(shared.size()\ ==\ 3);}
\DoxyCodeLine{00885\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Combinatorially\ duplicate\ face,\ these\ should\ be\ removed\ by}}
\DoxyCodeLine{00886\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ preprocessing}}
\DoxyCodeLine{00887\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00888\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00889\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(total\_shared\_vertices==\ 3)}
\DoxyCodeLine{00890\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00891\ \ \ \ \ \ \ \ \ \ \ assert(shared.size()\ ==\ 3);}
\DoxyCodeLine{00892\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Geometrically\ duplicate\ face,\ these\ should\ be\ removed\ by}}
\DoxyCodeLine{00893\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ preprocessing}}
\DoxyCodeLine{00894\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00895\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00896\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(total\_shared\_vertices\ ==\ 2)}
\DoxyCodeLine{00897\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00898\ \ \ \ \ \ \ \ \ \ \ assert(shared.size()\ ==\ 2);}
\DoxyCodeLine{00899\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Q:\ What\ about\ coplanar?}}
\DoxyCodeLine{00900\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00901\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ o\ \ \ \ o}}
\DoxyCodeLine{00902\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ |\(\backslash\)\ \ /|}}
\DoxyCodeLine{00903\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ |\ \(\backslash\)/\ |}}
\DoxyCodeLine{00904\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ |\ /\(\backslash\)\ |}}
\DoxyCodeLine{00905\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ |/\ \ \(\backslash\)|}}
\DoxyCodeLine{00906\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ o-\/-\/-\/-\/o}}
\DoxyCodeLine{00907\ \ \ \ \ \ \ \ \ \ \ double\_shared\_vertex(A,B,fa,fb,shared);}
\DoxyCodeLine{00908\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00909\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00910\ \ \ \ \ \ \ \ \ assert(total\_shared\_vertices<=1);}
\DoxyCodeLine{00911\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(total\_shared\_vertices==1)}
\DoxyCodeLine{00912\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00913\ \ \ \ \ \ \ \ \ \ \ single\_shared\_vertex(A,B,fa,fb,shared[0].first,shared[0].second);}
\DoxyCodeLine{00914\ \ \ \ \ \ \ \ \ \}\textcolor{keywordflow}{else}}
\DoxyCodeLine{00915\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00916\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceigl_a4f72acbb659a5c1d291a4cff36910a87}{intersect}}(A,B,fa,fb);}
\DoxyCodeLine{00917\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00918\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00919\ \ \ \ \ \}\textcolor{keywordflow}{catch}(\textcolor{keywordtype}{int}\ e)}
\DoxyCodeLine{00920\ \ \ \ \ \{}
\DoxyCodeLine{00921\ \ \ \ \ \ \ std::lock\_guard<std::mutex>\ exception\_lock(exception\_mutex);}
\DoxyCodeLine{00922\ \ \ \ \ \ \ exception\_fired\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00923\ \ \ \ \ \ \ exception\ =\ e;}
\DoxyCodeLine{00924\ \ \ \ \ \}}
\DoxyCodeLine{00925\ \ \ \};}
\DoxyCodeLine{00926\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ num\_threads\ =\ \mbox{\hyperlink{namespaceigl_aa03c54b4a3c8a07853528d49455f4fcc}{default\_num\_threads}}();}
\DoxyCodeLine{00927\ \ \ assert(num\_threads\ >\ 0);}
\DoxyCodeLine{00928\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ num\_pairs\ =\ candidate\_triangle\_pairs.size();}
\DoxyCodeLine{00929\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ chunk\_size\ =\ num\_pairs\ /\ num\_threads;}
\DoxyCodeLine{00930\ \ \ std::vector<std::thread>\ threads;}
\DoxyCodeLine{00931\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i=0;\ i<num\_threads-\/1;\ i++)}
\DoxyCodeLine{00932\ \ \ \{}
\DoxyCodeLine{00933\ \ \ \ \ threads.emplace\_back(process\_chunk,\ i*chunk\_size,\ (i+1)*chunk\_size);}
\DoxyCodeLine{00934\ \ \ \}}
\DoxyCodeLine{00935\ \ \ \textcolor{comment}{//\ Do\ some\ work\ in\ the\ master\ thread.}}
\DoxyCodeLine{00936\ \ \ process\_chunk((num\_threads-\/1)*chunk\_size,\ num\_pairs);}
\DoxyCodeLine{00937\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ t\ :\ threads)}
\DoxyCodeLine{00938\ \ \ \{}
\DoxyCodeLine{00939\ \ \ \ \ \textcolor{keywordflow}{if}\ (t.joinable())\ t.join();}
\DoxyCodeLine{00940\ \ \ \}}
\DoxyCodeLine{00941\ \ \ \textcolor{keywordflow}{if}(exception\_fired)\ \textcolor{keywordflow}{throw}\ exception;}
\DoxyCodeLine{00942\ \ \ \textcolor{comment}{//process\_chunk(0,\ candidate\_triangle\_pairs.size());}}
\DoxyCodeLine{00943\ \}}
\DoxyCodeLine{00944\ }
\DoxyCodeLine{00945\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
